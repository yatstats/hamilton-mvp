<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Alumni News • Hamilton YATSTATS</title>

<link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400&family=Bebas+Neue&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0c0c0c; --header:#000; --fg:#f2f2f2; --muted:#c4c4c4; --ink:#e8e8e8; --line:rgba(255,255,255,.08);
  --card:#151515; --chip:#232323; --accent:#ffffff;
  --pad:16px; --radius:12px;
  --hamSmall:13px; --hamBig:20px; --hamBigger:24px;
}
*{box-sizing:border-box}
html,body{margin:0}
body{background:var(--bg);color:var(--fg);font-family:Oswald,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}

/* Header / topbar like flip-cards */
.header{position:sticky;top:0;z-index:60;background:var(--header);border-bottom:1px solid var(--line)}
.container{max-width:1400px;margin:0 auto;padding:0 var(--pad)}
.topbar{display:flex;align-items:center;gap:10px;padding:10px 0}
.left-icons,.right-icons{display:flex;align-items:center;gap:8px}
.icon-btn{background:none;border:0;color:var(--fg);opacity:.92;display:inline-flex;align-items:center;justify-content:center;padding:6px;cursor:pointer}
.icon-btn i{font-size:20px}
h1.brand{margin:0;font:400 28px/1 "Bebas Neue",sans-serif;letter-spacing:.02em}

/* title row */
.title-row{display:flex;align-items:center;gap:12px;padding:10px 0 6px}
.page-title{font:700 28px/1 "Bebas Neue",sans-serif;letter-spacing:.06em;text-transform:uppercase}

/* controls */
.controls{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.controls .date{display:flex;gap:8px}
input[type="date"]{background:#0f0f0f;border:1px solid var(--line);color:var(--fg);padding:8px 10px;border-radius:10px;font:400 14px Oswald}
.controls .refresh{display:inline-flex;gap:8px;align-items:center}
.hr{border-top:1px solid var(--line)}

/* layout */
.layout{display:grid;grid-template-columns:2fr 2fr 1.4fr;gap:14px;align-items:start;margin:14px 0 80px}
.section-card{background:var(--card);border:1px solid var(--line);border-radius:14px;overflow:hidden}
.section-title{background:#222;border-bottom:1px solid var(--line);padding:10px 12px;font:700 18px "Bebas Neue",sans-serif;letter-spacing:.06em;text-transform:uppercase}
.section-body{padding:10px}

/* weekly grouping */
.week-group{border:1px solid var(--line);border-radius:12px;overflow:hidden;margin-bottom:14px;background:#121212}
.week-title{background:#1e1e1e;padding:8px 10px;font:700 16px "Bebas Neue",sans-serif;letter-spacing:.06em}
.week-pad{padding:8px 10px}

/* news card (5:7 portrait thumb) */
.news-card{display:flex;gap:12px;background:#141414;border:1px solid var(--line);border-radius:12px;padding:10px;margin-bottom:10px;align-items:center}
.thumb{width:110px;aspect-ratio:5/7;background:#000;border-radius:8px;overflow:hidden;flex:0 0 110px}
.thumb img{width:100%;height:100%;object-fit:cover;display:block}
.news-main{min-width:0;flex:1}
.news-hl{font:700 18px/1.1 "Bebas Neue",sans-serif;margin:0 0 4px}
.news-meta{font:300 12px/1 Oswald;color:var(--muted);margin-bottom:4px}
.news-player{font:400 13px/1 Oswald;color:#e9e9e9;letter-spacing:.02em}
.news-open{opacity:.9}

/* line scores */
.player-block{border:1px solid var(--line);border-radius:10px;margin:10px 0;background:#151515}
.player-name{padding:10px 10px 6px;font:700 18px "Bebas Neue",sans-serif;letter-spacing:.06em; text-transform:uppercase}
.line-row{display:flex;gap:10px;align-items:center;padding:6px 10px 8px}
.date-pill{background:var(--chip);border:1px solid var(--line);border-radius:999px;padding:4px 10px;font:700 12px "Bebas Neue",sans-serif;letter-spacing:.06em}
.line-text{font:400 13px/1.15 Oswald;color:var(--ink)} /* same size/weight as news player row (non-bold) */

/* drawers */
.drawer-mask{position:fixed;inset:0;background:rgba(0,0,0,.35);opacity:0;pointer-events:none;transition:opacity .2s;z-index:80}
.drawer{position:fixed;top:0;bottom:0;right:0;width:min(360px,86vw);background:rgba(12,12,12,.9);backdrop-filter:blur(4px);transform:translateX(110%);transition:transform .25s;border-left:1px solid var(--line);z-index:90;color:var(--ink)}
.drawer.open{transform:translateX(0)}
.drawer .drawer-head{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;border-bottom:1px solid var(--line)}
.drawer .drawer-body{padding:12px 14px;overflow:auto;height:calc(100% - 52px)}
.frow{margin-bottom:14px}
.frow .label{font:700 14px "Bebas Neue",sans-serif;letter-spacing:.06em;margin-bottom:6px}
.chk{display:flex;align-items:center;gap:8px;margin:6px 0}
.chk input{accent-color:#fff}

/* responsive layout changes */
@media (max-width:1199px){
  .layout{grid-template-columns:1.6fr 1fr;gap:12px}
  #colPro,#colCollege{display:none}
  #colNewsAll{display:block}
}
@media (min-width:1200px){
  #colNewsAll{display:none}
}
@media (max-width:900px){
  .layout{grid-template-columns:1fr}
  #colPro,#colCollege,#colNewsAll,#colLineScores{display:block}
}

/* small utilities */
a{color:inherit;text-decoration:none}
a.underline:hover{text-decoration:underline}
.hidden{display:none}
</style>
</head>
<body>

<header class="header">
  <div class="container">
    <div class="topbar">
      <button class="icon-btn" id="btnOpenFilters" title="Filters"><i class="ri-menu-3-line"></i></button>
      <h1 class="brand">ALUMNI NEWS</h1>
      <div class="controls" style="margin-left:auto">
        <div class="date">
          <input id="fromDate" type="date">
          <input id="toDate" type="date">
        </div>
        <button class="icon-btn refresh" id="btnRefresh" title="Refresh"><i class="ri-refresh-line"></i><span style="font:400 14px Oswald">Refresh</span></button>
      </div>
    </div>
  </div>
  <div class="hr"></div>
</header>

<main class="container">
  <div class="layout" id="layout">
    <!-- Left: PRO -->
    <section id="colPro" class="section-card" aria-live="polite">
      <div class="section-title">ALUMNI HEADLINES (Pros)</div>
      <div class="section-body" id="proNews"></div>
    </section>

    <!-- Middle: COLLEGE -->
    <section id="colCollege" class="section-card" aria-live="polite">
      <div class="section-title">ALUMNI HEADLINES (College)</div>
      <div class="section-body" id="collegeNews"></div>
    </section>

    <!-- Tablet single news column -->
    <section id="colNewsAll" class="section-card" aria-live="polite">
      <div class="section-title">ALUMNI HEADLINES</div>
      <div class="section-body" id="allNews"></div>
    </section>

    <!-- Right: LINE SCORES -->
    <section id="colLineScores" class="section-card" aria-live="polite">
      <div class="section-title">ALUMNI LINE SCORES</div>
      <div class="section-body" id="lineScores"></div>
    </section>
  </div>
</main>

<!-- Filters Drawer -->
<div class="drawer-mask" id="drawerMask"></div>
<aside class="drawer" id="filtersDrawer" aria-label="Filters">
  <div class="drawer-head">
    <div class="label" style="font:700 18px 'Bebas Neue',sans-serif;letter-spacing:.06em">FILTERS</div>
    <button class="icon-btn" id="btnCloseFilters"><i class="ri-close-line"></i></button>
  </div>
  <div class="drawer-body">
    <div class="frow">
      <div class="label">By Status</div>
      <label class="chk"><input type="checkbox" class="f-status" value="ACTIVE 2025"> ACTIVE 2025</label>
      <label class="chk"><input type="checkbox" class="f-status" value="ACTIVE 2024"> ACTIVE 2024</label>
      <label class="chk"><input type="checkbox" class="f-status" value="FREE AGENT"> FREE AGENT</label>
      <label class="chk"><input type="checkbox" class="f-status" value="INJURED"> INJURED</label>
    </div>

    <div class="frow">
      <div class="label">By Level</div>
      <div id="levelChecks"></div>
    </div>

    <div class="frow">
      <div class="label">By Graduating Class</div>
      <div id="classChecks"></div>
    </div>

    <div class="frow">
      <div class="label">Search by name</div>
      <input id="nameFilter" type="text" placeholder="Type a name…" style="width:100%;background:#0f0f0f;border:1px solid var(--line);color:var(--fg);padding:8px 10px;border-radius:10px;font:400 14px Oswald">
    </div>

    <div class="frow" style="display:flex;gap:10px;justify-content:flex-end">
      <button class="icon-btn" id="btnReset"><i class="ri-restart-line"></i><span style="font:400 14px Oswald">Reset</span></button>
      <button class="icon-btn" id="btnApply"><i class="ri-check-line"></i><span style="font:400 14px Oswald">Done</span></button>
    </div>
  </div>
</aside>

<footer style="position:fixed;left:0;right:0;bottom:0;background:#0b0b0b;border-top:1px solid var(--line);height:64px;display:flex;align-items:center;justify-content:center;z-index:50">
  <img src="assets/img/sponsor-1200x120.jpg" alt="Sponsor Banner" style="height:100%;object-fit:contain">
</footer>

<script>
/* ========== CONFIG ==========
   Master roster CSV is the same you already publish.
   ⚠️ TODO: Paste your **GAMES TAB** published CSV URL below.
*/
const ROSTER_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQcWJM6Q6hTdFnES_G5LUy4teCS-sJ5HdAc9F5HSY8DGE9egdGy8yUAe2ShT3tFm-CwUuCYeAYy_YiW/pub?gid=2028135390&single=true&output=csv";

/* >>>>> PASTE YOUR GAMES TAB CSV URL HERE <<<<< */
const GAMES_CSV_URL =
  (window.__GAMES_CSV || "")
  || "PUT-YOUR-GAMES-TAB-PUBLISHED-CSV-URL-HERE";

/* Alumni news cache file (seeded JSON with headlines) */
const NEWS_JSON_URL = "assets/news/alumni_news.json";

/* desktop/mobile breakpoints are handled in CSS */

/* ===== utilities ===== */
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));

function csvToRows(text){
  const lines = text.replace(/\r/g,'').split('\n').filter(Boolean);
  return lines.map(l=>{
    const out=[]; let cur='',q=false;
    for(let i=0;i<l.length;i++){
      const c=l[i];
      if(c==='"'){ if(q && l[i+1]==='"'){cur+='"'; i++;} else q=!q; }
      else if(c===',' && !q){ out.push(cur); cur=''; }
      else cur+=c;
    }
    out.push(cur);
    return out;
  });
}
function parseCSV(text){
  const rows = csvToRows(text);
  const head = rows.shift().map(h=>h.trim());
  return rows.map(r=>{
    const o={}; head.forEach((h,i)=>o[h]=r[i]??""); return o;
  });
}
function dFmt(d){ return d.toLocaleDateString(undefined,{month:'long',day:'numeric',year:'numeric'}); }
function shortMD(d){ return d.toLocaleDateString(undefined,{month:'numeric',day:'numeric'}); }
function weekStart(d){
  const x=new Date(d); const dow=x.getDay(); // 0 Sun
  const diff = (dow+6)%7; // make Monday week start
  x.setDate(x.getDate()-diff); x.setHours(0,0,0,0); return x;
}
function weekKey(d){ return weekStart(d).toISOString().slice(0,10); }
function isPro(level){ return ['MLB','INTERNATIONAL','TRIPLE-A','DOUBLE-A','HIGH-A','LOW-A','INDY'].includes((level||'').toUpperCase()); }
function isCollege(level){ return (level||'').toUpperCase().startsWith('NCAA') || (level||'').toUpperCase()==='NAIA' || (level||'').toUpperCase()==='JUCO'; }

const LEVEL_ORDER = {
  "MLB":0, "INTERNATIONAL":1, "TRIPLE-A":2, "DOUBLE-A":3, "HIGH-A":4, "LOW-A":5, "INDY":6,
  "NCAA-D1":7, "NCAA-D2":8, "NCAA-D3":9, "NAIA":10, "JUCO":11
};
function defaultPlayerSort(a,b){
  const la=(LEVEL_ORDER[(a.level||'').toUpperCase()] ?? 99);
  const lb=(LEVEL_ORDER[(b.level||'').toUpperCase()] ?? 99);
  if(la!==lb) return la-lb;
  const ga=parseInt(a.grad_class||'9999',10);
  const gb=parseInt(b.grad_class||'9999',10);
  if(ga!==gb) return ga-gb; // older class first (like your grid)
  return (a.display_name||'').localeCompare(b.display_name||'');
}

/* ===== fetchers ===== */
async function loadRoster(){
  const r = await fetch(ROSTER_CSV_URL,{cache:'no-store'});
  const text = await r.text();
  const rows = parseCSV(text);
  return rows.map(x=>({
    display_name: x.display_name || `${x.first||''} ${x.last||''}`.trim(),
    first:x.first||'', last:x.last||'',
    grad_class:x.grad_class||'',
    letter_years:x.letter_years||'',
    status:x.status||'',
    level:x.level||'',
    team:x.team||'',
    org:x.org||'',
  }));
}
async function loadGames(){
  if(!GAMES_CSV_URL || GAMES_CSV_URL.startsWith('PUT-')){
    console.warn("GAMES_CSV_URL missing. Line scores will show only if last_game_* fields exist in roster JSON (fallback).");
    return [];
  }
  const r = await fetch(GAMES_CSV_URL,{cache:'no-store'});
  if(!r.ok){ console.warn("Games CSV fetch failed", r.status); return []; }
  const text = await r.text();
  const rows = parseCSV(text);
  // expected columns: player_name(A), daily_line_score(B), GameDateLocal(G), Opponent(I), HomeAway(J)
  return rows.map(x=>{
    const name = x.player_name || x['player_name'] || x['Player'] || '';
    const line = (x.daily_line_score||'').trim();
    const dt = new Date(x.GameDateLocal || x['GameDateLocal'] || x.Date || x['Date'] || '');
    if(String(dt)==='Invalid Date') return null;
    const opp = x.Opponent || x['Opponent'] || '';
    const ha  = (x.HomeAway||'').toUpperCase();
    const atvs = ha==='H' || ha==='HOME' ? 'vs.' : '@';
    const textLine = line ? `${atvs} ${opp} - ${line}` : `${atvs} ${opp} - DNP`;
    return { name, date:dt, text:textLine };
  }).filter(Boolean);
}
async function loadNews(){
  // array of: {title,url,image,publishedAt,player_display_name, player_tags:{ level, status, grad_class, team, org}}
  try{
    const r = await fetch(NEWS_JSON_URL,{cache:'no-store'});
    return await r.json();
  }catch(e){ console.warn("News JSON missing/invalid", e); return []; }
}

/* ===== filters state ===== */
const F = {
  from:null, to:null,
  status: new Set(),
  levels: new Set(),
  classes: new Set(),
  name: ''
};
function setDefaultDates(){
  const to = new Date(); to.setHours(23,59,59,999);
  const from = new Date(); from.setDate(to.getDate()-21); from.setHours(0,0,0,0);
  $('#fromDate').value = from.toISOString().slice(0,10);
  $('#toDate').value   = to.toISOString().slice(0,10);
}
function readDates(){
  F.from = $('#fromDate').value ? new Date($('#fromDate').value+'T00:00:00') : null;
  F.to   = $('#toDate').value   ? new Date($('#toDate').value+'T23:59:59') : null;
}

/* ===== renderers ===== */
function newsCard(n, playerMeta){
  const img = n.image || `https://picsum.photos/seed/${encodeURIComponent(n.title||'news')}/400/560`;
  const when = n.publishedAt ? new Date(n.publishedAt) : null;
  const metaLine = [
    playerMeta?.team || n.player_tags?.team || '',
    when ? '• '+dFmt(when) : ''
  ].join(' ').trim();
  const url = n.url ? n.url + (n.url.includes('?')?'&':'?')+'utm_source=yatstats' : '#';
  return `
    <a class="news-card" href="${url}" target="_blank" rel="noopener">
      <div class="thumb"><img src="${img}" alt=""></div>
      <div class="news-main">
        <h3 class="news-hl">${n.title||'Read more'}</h3>
        <div class="news-meta">${metaLine}</div>
        <div class="news-player">${n.player_display_name || ''}</div>
      </div>
      <i class="ri-external-link-line news-open"></i>
    </a>
  `;
}

function buildNewsColumns(allNews, players){
  // attach meta for filtering
  const byName = new Map(players.map(p=>[p.display_name.toLowerCase(),p]));

  const filtered = allNews.filter(n=>{
    const p = byName.get((n.player_display_name||'').toLowerCase());
    const level = (n.player_tags?.level) || (p?.level) || '';
    const status = (n.player_tags?.status) || (p?.status) || '';
    const grad = (n.player_tags?.grad_class) || (p?.grad_class) || '';

    // date range
    const d = n.publishedAt ? new Date(n.publishedAt) : null;
    if(F.from && d && d < F.from) return false;
    if(F.to && d && d > F.to) return false;

    // filters
    if(F.status.size && !F.status.has(status)) return false;
    if(F.levels.size && !F.levels.has(level)) return false;
    if(F.classes.size && !F.classes.has(String(grad))) return false;
    if(F.name && !(n.player_display_name||'').toLowerCase().includes(F.name)) return false;

    // stash meta back for rendering
    n.__meta = {level,status,grad,p};
    return true;
  });

  // group by week + pro/college
  const byWeek = new Map();
  for(const n of filtered){
    const d = new Date(n.publishedAt||Date.now());
    const wk = weekKey(d);
    if(!byWeek.has(wk)) byWeek.set(wk,{pro:[],college:[],all:[]});
    const bin = isPro(n.__meta.level) ? 'pro' : (isCollege(n.__meta.level) ? 'college' : 'pro');
    byWeek.get(wk)[bin].push(n);
    byWeek.get(wk).all.push(n);
  }

  // sort newest week first
  const weeks = Array.from(byWeek.entries()).sort((a,b)=> new Date(b[0]) - new Date(a[0]));

  // render
  const renderWeek = (label, arr, idPrefix) => {
    if(!arr.length) return '';
    // newest first
    arr.sort((a,b)=> new Date(b.publishedAt||0) - new Date(a.publishedAt||0));
    const htmlCards = arr.map(n=> newsCard(n, n.__meta?.p)).join('');
    return `
      <div class="week-group">
        <div class="week-title">${label}</div>
        <div class="week-pad">${htmlCards || `<div style="opacity:.7">No ${idPrefix} headlines this week.</div>`}</div>
      </div>
    `;
  };

  const proHTML = [];
  const collegeHTML = [];
  const allHTML = [];
  for(const [wk,v] of weeks){
    const label = `ALUMNI HEADLINES (${v.pro.length && v.college.length ? 'Pro/College' : (v.pro.length?'Pros':'College')}) – WEEK OF ${dFmt(new Date(wk))}`;
    proHTML.push( renderWeek(`ALUMNI HEADLINES (Pros) – WEEK OF ${dFmt(new Date(wk))}`, v.pro, 'pro') );
    collegeHTML.push( renderWeek(`ALUMNI HEADLINES (College) – WEEK OF ${dFmt(new Date(wk))}`, v.college, 'college') );
    allHTML.push( renderWeek(label, v.all, 'news') );
  }

  $('#proNews').innerHTML = proHTML.join('') || `<div class="week-pad" style="opacity:.7">No pro headlines in range.</div>`;
  $('#collegeNews').innerHTML = collegeHTML.join('') || `<div class="week-pad" style="opacity:.7">No college headlines in range.</div>`;
  $('#allNews').innerHTML = allHTML.join('') || `<div class="week-pad" style="opacity:.7">No headlines in range.</div>`;
}

function buildLineScores(players, games){
  // map display_name -> meta
  const byName = new Map(players.map(p=>[p.display_name.toLowerCase(),p]));
  // filter by dates & name filter & level/status/class
  const items = games.filter(g=>{
    const p = byName.get((g.name||'').toLowerCase());
    if(!p) return false;
    if(F.from && g.date < F.from) return false;
    if(F.to && g.date > F.to) return false;
    if(F.name && !p.display_name.toLowerCase().includes(F.name)) return false;
    if(F.status.size && !F.status.has(p.status)) return false;
    if(F.levels.size && !F.levels.has(p.level)) return false;
    if(F.classes.size && !F.classes.has(String(p.grad_class))) return false;
    g.__p = p;
    return true;
  });

  // group -> week -> player
  const byWeek = new Map();
  for(const it of items){
    const wk = weekKey(it.date);
    if(!byWeek.has(wk)) byWeek.set(wk, new Map());
    const m = byWeek.get(wk);
    const key = it.__p.display_name.toLowerCase();
    if(!m.has(key)) m.set(key, []);
    m.get(key).push(it);
  }

  // render weeks newest first; players sorted by defaultPlayerSort
  const weeks = Array.from(byWeek.entries()).sort((a,b)=> new Date(b[0]) - new Date(a[0]));
  const outWeeks = weeks.map(([wk,byPlayer])=>{
    const playersInWeek = Array.from(byPlayer.values()).map(arr=>arr[0].__p);
    playersInWeek.sort(defaultPlayerSort);

    const htmlPlayers = playersInWeek.map(p=>{
      const arr = byPlayer.get(p.display_name.toLowerCase()).sort((a,b)=> b.date - a.date);
      const rows = arr.map(x=>`
        <div class="line-row">
          <span class="date-pill">${shortMD(x.date)}</span>
          <span class="line-text">${x.text.replace(/\s+—\s+/g,' ').replace(/\s+-\s+/g,' - ')}</span>
        </div>
      `).join('');
      return `<div class="player-block">
        <div class="player-name">${p.display_name}</div>
        ${rows}
      </div>`;
    }).join('');

    return `
      <div class="week-group">
        <div class="section-title">ALUMNI LINE SCORES – WEEK OF ${dFmt(new Date(wk))}</div>
        <div class="week-pad">
          ${htmlPlayers || `<div style="opacity:.7">No line scores this week.</div>`}
        </div>
      </div>
    `;
  }).join('');

  $('#lineScores').innerHTML = outWeeks || `<div class="week-pad" style="opacity:.7">No line scores in range.</div>`;
}

/* ===== filters drawer ===== */
function openFilters(){ $('#drawerMask').style.opacity=1; $('#drawerMask').style.pointerEvents='auto'; $('#filtersDrawer').classList.add('open'); }
function closeFilters(){ $('#drawerMask').style.opacity=0; $('#drawerMask').style.pointerEvents='none'; $('#filtersDrawer').classList.remove('open'); }

function buildFilterLists(players){
  // levels
  const levels = Array.from(new Set(players.map(p=>p.level))).filter(Boolean).sort((a,b)=>{
    const da=LEVEL_ORDER[a.toUpperCase()]??99, db=LEVEL_ORDER[b.toUpperCase()]??99; return da-db;
  });
  $('#levelChecks').innerHTML = levels.map(l=>`<label class="chk"><input type="checkbox" class="f-level" value="${l}"> ${l}</label>`).join('');

  // classes
  const classes = Array.from(new Set(players.map(p=>String(p.grad_class)))).filter(Boolean).sort();
  $('#classChecks').innerHTML = classes.map(c=>`<label class="chk"><input type="checkbox" class="f-class" value="${c}"> ${c}</label>`).join('');
}

function readFilterUI(){
  F.status = new Set($$('.f-status:checked').map(x=>x.value));
  F.levels = new Set($$('.f-level:checked').map(x=>x.value));
  F.classes = new Set($$('.f-class:checked').map(x=>x.value));
  F.name = ($('#nameFilter').value||'').trim().toLowerCase();
  readDates();
}

/* ===== boot ===== */
let ROSTER=[], GAMES=[], NEWS=[];

async function boot(){
  setDefaultDates();
  // UI wiring
  $('#btnOpenFilters').onclick = openFilters;
  $('#btnCloseFilters').onclick = closeFilters;
  $('#drawerMask').onclick = closeFilters;
  $('#btnReset').onclick = () => { $$('.drawer input[type=checkbox]').forEach(c=>c.checked=false); $('#nameFilter').value=''; };
  $('#btnApply').onclick = ()=>{ closeFilters(); renderAll(); };
  $('#btnRefresh').onclick = ()=> renderAll();
  $('#fromDate').onchange = $('#toDate').onchange = ()=> renderAll();

  // data
  ROSTER = await loadRoster();
  buildFilterLists(ROSTER);
  [NEWS, GAMES] = await Promise.all([loadNews(), loadGames()]);
  renderAll();
}

function renderAll(){
  readFilterUI();
  buildNewsColumns(NEWS, ROSTER);
  buildLineScores(ROSTER, GAMES);
}

boot();
</script>
</body>
</html>