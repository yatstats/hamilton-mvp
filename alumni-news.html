<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>YAT?STATS News</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <!-- ===== HEADER ===== -->
  <header class="site-header">
    <h1>YAT?STATS</h1>
    <nav><!-- keep your nav here --></nav>
  </header>

  <!-- ===== FILTERS ===== -->
  <aside class="filters">
    <button id="filterPro">Pros</button>
    <button id="filterCollege">University</button>
    <button id="filterJUCO">JUCO</button>
    <button id="filterAll">All</button>
    <input id="searchBox" type="text" placeholder="Search players..."/>
  </aside>

  <!-- ===== MAIN ===== -->
  <main>
    <div id="newsGrid" class="cards-grid"></div>
  </main>

  <!-- ===== FOOTER ===== -->
  <footer class="site-footer">
    <p>&copy; 2025 YAT?STATS</p>
  </footer>

  <!-- ===== SCRIPT ===== -->
  <script>
    const $ = (sel) => document.querySelector(sel);

    function newsHTML(item){
      return `
      <div class="card">
        <div class="card-front">
          <img src="${item.image || 'assets/img/default-news.png'}" alt="${item.player} news" class="card-img"/>
          <div class="card-info">
            <h3 class="card-title">${item.headline}</h3>
            <p class="card-meta">${item.source} • ${new Date(item.date).toLocaleDateString()}</p>
            <p class="card-snippet">${item.snippet}</p>
            <a href="${item.url}" target="_blank" class="card-link">Read More →</a>
          </div>
        </div>
      </div>`;
    }

    function renderNews(list){
      const grid = $('#newsGrid');
      const groups = {
        MLB:"Huskies in the Pros",
        "NCAA-D1":"Division 1 & NAIA",
        "NCAA-D2":"Division 2",
        JUCO:"Junior College"
      };
      let html = "";
      for(const [level,title] of Object.entries(groups)){
        const items = list.filter(n => n.player_tags?.level === level);
        if(items.length){
          html += `<h2 class="section-title">${title}</h2>`;
          html += items.map(newsHTML).join('');
        }
      }
      grid.innerHTML = html || `<p style="color:#9ca3af;">No news right now.</p>`;
    }

    async function fetchNewsUpdates(){
      try{
        const resp = await fetch("news.json?_=" + Date.now());
        const items = await resp.json();
        window.NEWS = items.sort((a,b)=>new Date(b.date)-new Date(a.date));
        renderNews(window.NEWS);
      }catch(err){
        console.error("News fetch failed:",err);
        $('#newsGrid').innerHTML=`<p style="color:red;">Error loading news</p>`;
      }
    }

    fetchNewsUpdates();
    setInterval(fetchNewsUpdates,21600000); // every 6h
  </script>
</body>
</html>