<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>YatStats News</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- ===== HEADER ===== -->
  <header class="site-header">
    <h1>YAT?STATS</h1>
    <nav>
      <!-- keep your nav items here -->
    </nav>
  </header>

  <!-- ===== FILTERS ===== -->
  <aside class="filters">
    <button id="filterPro">Pros</button>
    <button id="filterCollege">University</button>
    <button id="filterJUCO">JUCO</button>
    <button id="filterAll">All</button>
    <input id="searchBox" type="text" placeholder="Search players..." />
  </aside>

  <!-- ===== MAIN CONTENT ===== -->
  <main>
    <div id="newsGrid" class="news-grid">
      <!-- News will render here -->
    </div>
  </main>

  <!-- ===== FOOTER ===== -->
  <footer class="site-footer">
    <p>&copy; 2025 YAT?STATS</p>
  </footer>

  <!-- ===== SCRIPT ===== -->
  <script>
    const $ = (sel) => document.querySelector(sel);

    // Render one news item
    function newsHTML(item){
      return `
      <article class="news-item">
        <img src="${item.image || 'assets/img/default-news.png'}" 
             alt="${item.player} headline image"
             style="width:100%;height:auto;border-radius:6px;margin-bottom:8px;object-fit:cover;" />
        <h3 class="news-headline">
          <a href="${item.url}" target="_blank" rel="noopener noreferrer">${item.headline}</a>
        </h3>
        <div class="news-player">Player: ${item.player}</div>
        <div class="news-meta">${item.source} â€¢ ${new Date(item.date).toLocaleString()}</div>
        <p class="news-snippet">${item.snippet}</p>
      </article>`;
    }

    // Group + render by level
    function renderNews(list){
      const grid = $('#newsGrid');
      if(!grid) return;

      const groups = {
        MLB: "Huskies in the Pros",
        "NCAA-D1": "Division 1 & NAIA",
        "NCAA-D2": "Division 2",
        JUCO: "Junior College"
      };

      let html = "";
      for (const [level, title] of Object.entries(groups)) {
        const items = list.filter(n => n.player_tags?.level === level);
        if(items.length > 0){
          html += `<h2 class="section-title">${title}</h2>`;
          html += items.map(newsHTML).join('');
        }
      }

      grid.innerHTML = html || `<p style="color:var(--muted);grid-column:1/-1;">No news right now.</p>`;
    }

    // Fetch + refresh every 6h
    async function fetchNewsUpdates() {
      try {
        const resp = await fetch("news.json?_=" + Date.now());
        const items = await resp.json();
        window.NEWS = items.sort((a, b) => new Date(b.date) - new Date(a.date));
        renderNews(window.NEWS);
      } catch (err) {
        console.error("News fetch failed:", err);
        $('#newsGrid').innerHTML = `<p style="color:red;grid-column:1/-1;">Error loading news</p>`;
      }
    }

    // Init
    fetchNewsUpdates();
    setInterval(fetchNewsUpdates, 21600000); // 6 hours
  </script>
</body>
</html>