<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Active Alumni News • Hamilton YATSTATS</title>
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400&family=Bebas+Neue&display=swap" rel="stylesheet">
  <style>
    /* (Your existing CSS, unchanged) */
    /* … */
  </style>
</head>
<body>
  <!-- (Your existing HTML for header, drawers, etc.) -->
  <!-- … -->
  <main class="main container">
    <div class="newsgrid" aria-live="polite">
      <div class="news-wrap">
        <section id="col-pro" class="news-col news-root overlay-mode">
          <h3>ALUMNI HEADLINES (Pros)</h3>
          <div id="proFeed" class="news-feed">
            <p style="color:var(--muted)">Loading…</p>
          </div>
        </section>
        <section id="col-college" class="news-col news-root overlay-mode">
          <h3>ALUMNI HEADLINES (College)</h3>
          <div id="collegeFeed" class="news-feed">
            <p style="color:var(--muted)">Loading…</p>
          </div>
        </section>
      </div>
      <aside class="scores-col">
        <!-- (Your scores markup) -->
      </aside>
    </div>
  </main>
  <footer class="site-footer">
    <!-- (Footer) -->
  </footer>

  <script type="application/json" id="news-json">
  {
    "items":[
      {
        "id":"1",
        "title":"Bellinger goes deep twice in Baltimore slugfest",
        "url":"https://example.com/bellinger-two-hr",
        "image":"assets/img/now_players/cody_bellinger.jpg",
        "source":"MLB.com",
        "publishedAt":"2025-09-21T22:15:00-07:00",
        "player_display_name":"Cody Bellinger",
        "tags":{"level":"MLB"}
      },
      {
        "id":"2",
        "title":"Swift flashes leather, reaches twice in SeaWolves win",
        "url":"https://example.com/swift-defense",
        "image":"assets/img/now_players/drew_swift.jpg",
        "source":"MiLB.com",
        "publishedAt":"2025-09-19T18:40:00-07:00",
        "player_display_name":"Drew Swift",
        "tags":{"level":"AA"}
      },
      {
        "id":"3",
        "title":"Hamel racks up 9 Ks over six strong",
        "url":"https://example.com/hamel-9k",
        "image":"assets/img/now_players/dom_hamel.jpg",
        "source":"MiLB.com",
        "publishedAt":"2025-09-20T19:00:00-07:00",
        "player_display_name":"Dom Hamel",
        "tags":{"level":"AAA"}
      },
      {
        "id":"4",
        "title":"Murphy locks down first KBO save",
        "url":"https://example.com/murphy-save",
        "image":"assets/img/now_players/patrick_murphy.jpg",
        "source":"Yonhap",
        "publishedAt":"2025-09-22T09:12:00-07:00",
        "player_display_name":"Patrick Murphy",
        "tags":{"level":"INTERNATIONAL"}
      },
      {
        "id":"5",
        "title":"Garcia homers as Wildcats rally",
        "url":"https://example.com/garcia-wildcats",
        "image":"assets/img/now_players/luis_garcia.jpg",
        "source":"Arizona Daily",
        "publishedAt":"2025-09-17T12:12:00-07:00",
        "player_display_name":"Luis Garcia",
        "tags":{"level":"NCAA-D1"}
      },
      {
        "id":"6",
        "title":"Kucherak strings together three-hit day for Northwestern",
        "url":"https://example.com/kucherak-three-hit",
        "image":"assets/img/now_players/ryan_kucherak.jpg",
        "source":"northwestern.edu",
        "publishedAt":"2025-09-18T13:05:00-07:00",
        "player_display_name":"Ryan Kucherak",
        "tags":{"level":"NCAA-D1"}
      }
    ]
  }
  </script>

  <script type="module">
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));

  const PRO_LEVELS = new Set([
    'MLB','INTERNATIONAL','TRIPLE-A','AAA','DOUBLE-A','AA',
    'HIGH-A','A+','LOW-A','A','ROOKIE','ROK','INDY'
  ]);
  const COLLEGE_LEVELS = new Set([
    'NCAA-D1','NCAA-D2','NCAA-D3','NAIA','JUCO'
  ]);

  let ALL_NEWS = [];

  function firstNameOf(full) {
    return String(full || '').trim().split(/\s+/)[0] || '';
  }

  function newsCardHTML(n) {
    const img = n.image || 'assets/img/news/placeholder.jpg';
    const when = n.publishedAt ? new Date(n.publishedAt).toLocaleString() : '';
    const src = n.source || 'News';
    const pname = n.player_display_name || '';
    const first = firstNameOf(pname);
    const shareText = encodeURIComponent(`We See Where YAT, ${first}! #YATABOY${first}`);
    const shareUrl = encodeURIComponent(n.url || location.href);
    const xHref = `https://twitter.com/intent/tweet?text=${shareText}&url=${shareUrl}`;
    const mailHref = `mailto:?subject=${encodeURIComponent(n.title || 'Hamilton Alumni News')}&body=${shareText}%0A${shareUrl}`;
    return `
      <article class="news-card">
        <a class="news-thumb" href="${n.url || '#'}" target="_blank" rel="noopener" style="background-image:url('${img}')" aria-label="Open story"></a>
        <div class="news-body">
          <a class="news-title" href="${n.url || '#'}" target="_blank" rel="noopener">${n.title || 'Read more'}</a>
          <div class="news-meta">${src} • ${when}</div>
          <div class="news-links">
            <a class="news-readmore" href="${n.url || '#'}" target="_blank" rel="noopener">READ MORE</a>
            <a class="news-market" href="marketplace.html">YAT-A-BOY MARKETPLACE</a>
          </div>
          <div class="news-share" aria-label="Share">
            <a class="icon-btn" href="${xHref}" target="_blank" rel="noopener" title="Share to X"><i class="ri-twitter-x-line"></i></a>
            <a class="icon-btn" href="#" title="Instagram"><i class="ri-instagram-line"></i></a>
            <a class="icon-btn" href="#" title="Facebook"><i class="ri-facebook-circle-line"></i></a>
            <a class="icon-btn" href="#" title="TikTok"><i class="ri-tiktok-line"></i></a>
            <a class="icon-btn" href="${mailHref}" title="Email"><i class="ri-mail-line"></i></a>
          </div>
        </div>
      </article>`;
  }

  function renderNewsLists() {
    const fromVal = $('#dateFrom')?.value;
    const toVal = $('#dateTo')?.value;
    const from = fromVal ? new Date(fromVal) : null;
    const to = toVal ? new Date(toVal + 'T23:59:59') : null;

    // Filter by date if needed
    const filtered = ALL_NEWS.filter(n => {
      if (!n.publishedAt) return false;
      const d = new Date(n.publishedAt);
      if (from && d < from) return false;
      if (to && d > to) return false;
      return true;
    });

    // Sort descending (newest first) — more intuitive for news
    filtered.sort((a, b) =>
      new Date(b.publishedAt) - new Date(a.publishedAt)
    );

    // Separate pros and college
    const pros = [];
    const college = [];

    filtered.forEach(n => {
      const lvl = String(n.tags?.level || '').trim().toUpperCase();
      if (PRO_LEVELS.has(lvl)) {
        pros.push(n);
      } else if (COLLEGE_LEVELS.has(lvl)) {
        college.push(n);
      } else {
        // Optionally: treat unknown-level as pro or log it
        // console.warn("News item with unexpected level:", n);
      }
    });

    // Limit how many you display
    const max = 5;
    const prosToShow = pros.slice(0, max);
    const colToShow = college.slice(0, max);

    $('#proFeed').innerHTML =
      prosToShow.length
        ? prosToShow.map(newsCardHTML).join('')
        : `<p style="color:var(--muted)">No pro headlines in range.</p>`;

    $('#collegeFeed').innerHTML =
      colToShow.length
        ? colToShow.map(newsCardHTML).join('')
        : `<p style="color:var(--muted)">No college headlines in range.</p>`;
  }

  document.addEventListener('DOMContentLoaded', () => {
    try {
      const raw = $('#news-json')?.textContent || '{}';
      const data = JSON.parse(raw);
      ALL_NEWS = Array.isArray(data.items) ? data.items : [];
    } catch (err) {
      console.error("Failed to parse news JSON:", err);
      ALL_NEWS = [];
    }
    renderNewsLists();
  });
  </script>

</body>
</html>
