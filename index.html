<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Where They YAT? — Hamilton</title>
<link rel="stylesheet" href="styles.css"/>
<link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet"/>
</head>
<body>

<header class="header">
  <div class="container topbar">
    <div class="left-icons">
      <button class="icon-btn" id="hamburger" aria-label="Menu"><i class="ri-menu-line"></i></button>
      <button class="icon-btn" id="account" aria-label="Account"><i class="ri-user-3-line"></i></button>
      <button class="icon-btn" id="theme" aria-label="Theme"><i class="ri-moon-line"></i></button>
    </div>

    <nav class="topnav hide-sm">
      <span class="nav-pair"><span class="thin">WHERE THEY</span><span class="bold">YAT?</span></span>
      <span class="nav-pair"><span class="thin">ACTIVE ALUMNI</span><span class="bold">NEWS</span></span>
      <span class="nav-pair"><span class="thin">NEXT-LEVEL</span><span class="bold">ALL-TIME LIST</span></span>
      <span class="nav-pair"><span class="thin">NIL & YAT-A-BOY</span><span class="bold">MARKETPLACE</span></span>
      <span class="nav-pair"><span class="thin">THE</span><span class="bold">CURRENT TEAM</span></span>
      <span class="nav-pair"><span class="thin">PCD ACTION</span><span class="bold">PARTNER PROGRAM</span></span>
      <span class="nav-pair"><span class="thin"></span><span class="bold">FAQ’S</span></span>
    </nav>

    <div class="wordmark">YAT?STATS</div>
  </div>

  <div class="hr"></div>

  <div class="container schoolrow">
    <img src="assets/img/hamilton-logo.png" alt="Hamilton H" onerror="this.style.opacity=.2">
    <div class="schooltext">
      <div class="small">CHANDLER, AZ</div>
      <div class="big1">HAMILTON HIGH SCHOOL</div>
      <div class="big2">ACTIVE ALUMNI</div>
    </div>
  </div>

  <div class="hr"></div>

  <section class="hero">
    <div class="container hero-grid">
      <div class="tagline">
        <div class="tag-duo">
          <span class="tag-swap"><span class="tag-grey">WHERE THEY</span> <span class="tag-bold">YAT?</span></span>
          <span class="tag-swap"><span class="tag-grey">FLIP FOR</span> <span class="tag-bold">STATS!</span></span>
        </div>
      </div>
      <div class="icon-row">
        <button class="icon-btn" id="openSearch"  aria-label="Search"><i class="ri-search-line"></i></button>
        <button class="icon-btn" id="openFilters" aria-label="Filters"><i class="ri-filter-3-line"></i></button>
        <button class="icon-btn" id="resetFilters" aria-label="Reset"><i class="ri-arrow-go-back-line"></i></button>
      </div>
    </div>
    <div class="container">
      <div class="crumbs"><span class="subname">HAMILTON</span> ▸ WHERE THEY YAT?</div>
    </div>
  </section>
</header>

<!-- LEFT DRAWER: search -->
<div class="drawer-mask"></div>
<aside class="drawer" id="drawerLeft" aria-label="Left drawer">
  <h3>PLAYER PROFILE SEARCH</h3>
  <div class="pad">
    <input id="playerSearch" class="input" placeholder="Type to search…" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--line);background:rgba(255,255,255,.06);color:var(--ink)"/>
    <div id="liveResults"></div>
  </div>
  <div class="pad">
    <h3>Navigation</h3>
    <div style="display:flex;flex-direction:column;gap:12px">
      <a href="index.html"><span class="thin">WHERE THEY</span> <span class="bold">YAT?</span></a>
      <a href="#"><span class="thin">ACTIVE ALUMNI</span> <span class="bold">NEWS</span></a>
      <a href="#"><span class="thin">NEXT-LEVEL</span> <span class="bold">ALL-TIME LIST</span></a>
      <a href="#"><span class="thin">NIL & YAT-A-BOY</span> <span class="bold">MARKETPLACE</span></a>
      <a href="#"><span class="thin">THE</span> <span class="bold">CURRENT TEAM</span></a>
      <a href="#"><span class="thin">PCD ACTION</span> <span class="bold">PARTNER PROGRAM</span></a>
      <a href="#"><span class="thin"></span> <span class="bold">FAQ’S</span></a>
    </div>
  </div>
  <button class="icon-btn close-btn" onclick="document.body.classList.remove('drawer-left-open')"><i class="ri-close-line"></i></button>
</aside>

<!-- RIGHT DRAWER: filters -->
<aside class="drawer drawer-right" id="drawerRight" aria-label="Filters">
  <h3>Filters</h3>
  <div id="filters" class="pad" style="display:flex;flex-direction:column;gap:16px">
    <div>
      <div class="small" style="margin-bottom:6px">By NAME</div>
      <input id="filterName" placeholder="Type a name…" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--line);background:rgba(255,255,255,.06);color:var(--ink)"/>
    </div>

    <div id="filterLevels">
      <div class="small" style="margin-bottom:6px">By LEVEL</div>
      <label><input type="checkbox" value="MLB"> MLB</label>
      <label><input type="checkbox" value="TRIPLE-A"> TRIPLE-A</label>
      <label><input type="checkbox" value="DOUBLE-A"> DOUBLE-A</label>
      <label><input type="checkbox" value="HIGH-A"> HIGH-A</label>
      <label><input type="checkbox" value="LOW-A"> LOW-A</label>
      <label><input type="checkbox" value="ROOKIE"> ROOKIE</label>
      <label><input type="checkbox" value="INDY"> INDY</label>
      <label><input type="checkbox" value="INTERNATIONAL"> INTERNATIONAL</label>
      <label><input type="checkbox" value="NCAA-D1"> NCAA-D1</label>
      <label><input type="checkbox" value="NCAA-D2"> NCAA-D2</label>
      <label><input type="checkbox" value="NCAA-D3"> NCAA-D3</label>
      <label><input type="checkbox" value="NAIA"> NAIA</label>
      <label><input type="checkbox" value="JUCO"> JUCO</label>
    </div>

    <div id="filterClasses">
      <div class="small" style="margin-bottom:6px">By GRAD CLASS</div>
      <div style="display:flex;flex-wrap:wrap;gap:8px">
        <!-- static 2025..1999 -->
        <script>
          document.currentScript.insertAdjacentHTML('afterend',
            [...Array(27)].map((_,i)=>2025-i).map(y=>`<label><input type="checkbox" value="${y}"> ${y}</label>`).join(' ')
          );
        </script>
      </div>
    </div>

    <div id="filterRoster">
      <div class="small" style="margin-bottom:6px">By ROSTER YEAR</div>
      <div style="display:flex;flex-wrap:wrap;gap:8px">
        <script>
          document.currentScript.insertAdjacentHTML('afterend',
            [...Array(27)].map((_,i)=>2025-i).map(y=>`<label><input type="checkbox" value="${y}"> ${y}</label>`).join(' ')
          );
        </script>
      </div>
    </div>

    <div id="filterStatus">
      <div class="small" style="margin-bottom:6px">By STATUS</div>
      <label><input type="checkbox" value="ACTIVE 2025"> ACTIVE 2025</label>
      <label><input type="checkbox" value="FREE AGENT"> FREE AGENT</label>
      <label><input type="checkbox" value="INJURED"> INJURED</label>
      <label><input type="checkbox" value="ACTIVE 2024"> ACTIVE 2024</label>
      <label><input type="checkbox" value="RETIRED"> RETIRED</label>
      <label><input type="checkbox" value="SPONSOR"> SPONSOR</label>
    </div>

    <div style="display:flex;gap:10px">
      <button id="filtersApply" class="icon-btn" style="padding:10px 14px;border:1px solid var(--line);border-radius:12px"><i class="ri-check-line"></i>&nbsp;Apply</button>
      <button id="filtersReset" class="icon-btn" style="padding:10px 14px;border:1px solid var(--line);border-radius:12px"><i class="ri-restart-line"></i>&nbsp;Reset</button>
      <button class="icon-btn close-btn" onclick="document.body.classList.remove('drawer-right-open')" style="margin-left:auto"><i class="ri-close-line"></i></button>
    </div>
  </div>
</aside>

<main class="container" style="padding:16px 14px 80px">
  <div id="cardGrid" class="grid"></div>
</main>

<!-- sticky footer nav -->
<footer class="footer-tabs">
  <div class="container tabs">
    <a href="#">BIO</a><a href="#">NEWS</a><a href="#">STATS</a><a href="#">SOCIAL</a><a href="#">NIL SCORE</a><a href="#">VIDEO</a><a href="#">PICS</a>
  </div>
</footer>

<script>
/* ====== UTIL ====== */
const CSV_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vSB4q8nvjYfftVeWKkFNz42uDDWSuDXikimMa-a25WQk_XX-imZbiUd8q5Cj94rjZJjaabw5DGMvJFd/pub?gid=82179728&single=true&output=csv";
const $=s=>document.querySelector(s), $$=s=>Array.from(document.querySelectorAll(s));
const debounce=(fn,ms=180)=>{let t;return(...a)=>{clearTimeout(t);t=setTimeout(()=>fn(...a),ms);};};
/* drawers */
$('#hamburger').onclick=()=>document.body.classList.add('drawer-left-open');
$('#openSearch') .onclick=()=>document.body.classList.add('drawer-left-open');
$('#openFilters').onclick=()=>document.body.classList.add('drawer-right-open');
$('.drawer-mask').onclick=()=>document.body.classList.remove('drawer-left-open','drawer-right-open');

/* load CSV -> window.PLAYERS */
async function loadCSV(url){
  const txt=await fetch(url,{cache:'no-store'}).then(r=>r.text());
  const rows=txt.trim().split(/\r?\n/).map(r=>r.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/).map(c=>c.replace(/^"|"$/g,'')));
  const header=rows.shift();
  const idx=n=>header.indexOf(n);
  return rows.map(r=>({
    CONTROL:r[idx('CONTROL')],
    id:r[idx('tbc_id')]||r[idx('id')],
    slug:r[idx('slug')],
    display_name:r[idx('display_name')],
    first:r[idx('first')], last:r[idx('last')],
    grad_class:r[idx('grad_class')],
    letter_years:r[idx('letter_years')],
    status:r[idx('status')], level:r[idx('level')],
    team:r[idx('team')], org:r[idx('org')], city_state:r[idx('city_state')],
    position:r[idx('position')],
    front_img:r[idx('front_img')], hs_img:r[idx('hs_img')],
  }));
}

/* default sort rules */
function defaultSort(a,b){
  const orderStatus=['ACTIVE 2025','FREE AGENT','INJURED','ACTIVE 2024','RETIRED','SPONSOR'];
  const sA=orderStatus.indexOf(a.status), sB=orderStatus.indexOf(b.status);
  if(sA!==sB) return sA-sB;
  const cA=+a.grad_class||0, cB=+b.grad_class||0;
  if(cA!==cB) return cA-cB;         // oldest first
  const lvlRank=v=>({'MLB':9,'TRIPLE-A':8,'DOUBLE-A':7,'HIGH-A':6,'LOW-A':5,'ROOKIE':4,'INDY':3,'INTERNATIONAL':2,'NCAA-D1':1,'NCAA-D2':1,'NCAA-D3':1,'NAIA':1,'JUCO':1}[v]||0);
  const L=lvlRank(a.level)-lvlRank(b.level); if(L!==0) return -L;
  const yrs=p=>String(p.letter_years||'').split(',').filter(Boolean).length;
  const vy=yrs(a)-yrs(b); if(vy!==0) return -vy;
  const lastA=(a.last||(a.display_name||'').split(' ').slice(-1)[0]||'').toLowerCase();
  const lastB=(b.last||(b.display_name||'').split(' ').slice(-1)[0]||'').toLowerCase();
  return lastA.localeCompare(lastB);
}

/* render cards */
function rosterBadges(p){
  const yrs=String(p.letter_years||'').split(',').map(s=>s.trim()).filter(Boolean).map(y=>y.slice(-2));
  return yrs.map(y=>`<span class="chip">${y}</span>`).join('');
}
function cardHTML(p){
  const name=p.display_name||(p.first&&p.last?`${p.first} ${p.last}`:'');
  const bg=p.front_img||'assets/img/placeholder.jpg';
  return `
  <article class="card">
    <div class="card-inner">
      <div class="bg" style="background-image:url('${bg}')"></div>
      <div class="shade"></div>
      <div class="cap">
        <div class="name">${name}</div>
        <div style="font-size:12px;opacity:.9">${p.team||''}</div>
        <div class="chips">
          <span class="chip">${p.status||''}</span>
          ${rosterBadges(p)}
        </div>
      </div>
    </div>
  </article>`;
}
function renderCards(list){
  const grid=$("#cardGrid"); grid.innerHTML=list.map(cardHTML).join('');
  // click → profile
  $$("#cardGrid .card").forEach((el,i)=>{
    const p=list[i]; const id=p.id||p.slug||'';
    el.addEventListener('click',()=>window.location.href=`profile.html?id=${encodeURIComponent(id)}`);
  });
}

/* filters + live search (reused functions) */
function readFilters(){
  const name=($('#filterName')?.value||'').trim().toLowerCase();
  const levels=$$('#filterLevels input:checked').map(i=>i.value);
  const classes=$$('#filterClasses input:checked').map(i=>i.value);
  const years=$$('#filterRoster input:checked').map(i=>i.value);
  const status=$$('#filterStatus input:checked').map(i=>i.value);
  return {name,levels,classes,years,status};
}
function applyFilters(){
  const F=readFilters();
  const filtered=(window.PLAYERS||[]).filter(p=>{
    const nameOk=!F.name||((p.display_name||(`${p.first} ${p.last}`)||'').toLowerCase().includes(F.name));
    const lvlOk=!F.levels.length||F.levels.includes(p.level);
    const classOk=!F.classes.length||F.classes.includes(String(p.grad_class));
    const yearOk=!F.years.length||String(p.letter_years||'').split(',').some(y=>F.years.includes(y.trim()));
    const statOk=!F.status.length||F.status.includes(p.status);
    return nameOk&&lvlOk&&classOk&&yearOk&&statOk;
  });
  renderCards(filtered);
  document.body.classList.remove('drawer-right-open');
}
function resetFilters(){ $$('#filters input[type="checkbox"]').forEach(i=>i.checked=false); $('#filterName').value=''; }

/* live results */
const searchInput=document.getElementById('playerSearch');
const liveBox=document.getElementById('liveResults');
const makeHit=(p)=>{
  const el=document.createElement('div'); el.className='live-hit';
  el.innerHTML=`<img src="${p.hs_img||p.front_img||'assets/img/placeholder.jpg'}"><div><div style="font-weight:700">${p.display_name||p.first+' '+p.last}</div><div style="opacity:.7;font-size:.92em">${p.level||''} • Class of ${p.grad_class||''}</div></div>`;
  el.onclick=()=>location.href=`profile.html?id=${encodeURIComponent(p.id||p.slug||'')}`;
  return el;
};
const live = ()=> {
  const q=(searchInput.value||'').trim().toLowerCase();
  if(!q){ liveBox.innerHTML=''; return; }
  const hits=(window.PLAYERS||[]).filter(p=>((p.display_name||(`${p.first} ${p.last}`)||'').toLowerCase().includes(q))).slice(0,25);
  liveBox.innerHTML=''; hits.forEach(p=>liveBox.appendChild(makeHit(p)));
};
searchInput?.addEventListener('input', debounce(live,120));
$('#filtersApply')?.addEventListener('click',applyFilters);
$('#filtersReset')?.addEventListener('click',()=>{resetFilters();applyFilters();});
$('#resetFilters')?.addEventListener('click',()=>{resetFilters();renderCards((window.PLAYERS||[]).slice().sort(defaultSort));});

/* boot */
(async()=>{
  window.PLAYERS=await loadCSV(CSV_URL);
  renderCards(window.PLAYERS.slice().sort(defaultSort));
})();
</script>
</body>
</html>