<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>YAT?STATS • HS SEARCH</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&family=Bebas+Neue&display=swap"
      rel="stylesheet"
    />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      * {
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto,
          "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      }

      .banner-small {
        letter-spacing: 0.18em;
        text-transform: uppercase;
        white-space: nowrap;
      }

      .banner-school {
        font-family: "Bebas Neue", sans-serif;
        letter-spacing: 0.16em;
        text-transform: uppercase;
        line-height: 1;
      }
    </style>
  </head>

  <body class="bg-black text-white">
    <section class="py-14">
      <div class="max-w-5xl mx-auto px-6 text-center">
        <h2 class="text-3xl md:text-4xl font-extrabold mb-3">
          SEARCH 17,000+<br />HS BASEBALL PROGRAMS
        </h2>

        <div class="max-w-3xl mx-auto grid sm:grid-cols-3 gap-3 mt-6">
          <input
            id="school-search-input"
            class="bg-neutral-900 border border-neutral-700 rounded-md p-3"
            placeholder="E.g., HAMILTON"
          />
          <select
            id="state-filter"
            class="bg-neutral-900 border border-neutral-700 rounded-md p-3"
          >
            <option value="">All States</option>
          </select>
          <button
            id="search-button"
            class="bg-neutral-100 text-black font-semibold rounded-md"
          >
            Search
          </button>
        </div>

        <div id="results-container" class="mt-10 hidden">
          <div id="results-content"></div>
        </div>
      </div>
    </section>

    <script>
      /*************************************************
       * CONFIG — CHANGE THIS WHEN MOVING HOSTS
       *************************************************/

      // ✅ For Vercel / production:
      // const API_ORIGIN = "";

      // ✅ For GitHub Pages testing:
      const API_ORIGIN = "https://5004.yatstats.com";

      const API_PATH = API_ORIGIN + "/api/hs-programs";

      const STATE_ABBR = {
        AZ: "Arizona",
        CA: "California",
        TX: "Texas",
        FL: "Florida",
      };

      const qInput = document.getElementById("school-search-input");
      const stateSel = document.getElementById("state-filter");
      const searchBtn = document.getElementById("search-button");
      const resultsWrap = document.getElementById("results-container");
      const resultsEl = document.getElementById("results-content");

      Object.entries(STATE_ABBR).forEach(([abbr, name]) => {
        const opt = document.createElement("option");
        opt.value = abbr;
        opt.textContent = name;
        stateSel.appendChild(opt);
      });

      async function runSearch() {
        const params = new URLSearchParams();
        if (qInput.value) params.set("q", qInput.value);
        if (stateSel.value) params.set("state", stateSel.value);

        const res = await fetch(`${API_PATH}?${params.toString()}`);
        const data = await res.json();

        resultsWrap.classList.remove("hidden");
        resultsEl.innerHTML = "";

        data.programs.forEach((p) => {
          resultsEl.innerHTML += `
            <div class="border border-neutral-800 p-6 rounded-xl mb-6">
              <p class="banner-small text-neutral-400">${p.city}, ${p.state}</p>
              <p class="banner-school text-2xl">${p.hsname}</p>
            </div>
          `;
        });
      }

      searchBtn.addEventListener("click", runSearch);
    </script>
  </body>
</html>
