<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Player Profile – Hamilton Active Baseball Alumni</title>

  <!-- Icons + Fonts -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400&family=Bebas+Neue&display=swap" rel="stylesheet">

  <!-- Firebase init (same pattern as index.html) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import {
      getAuth,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      signOut,
      onAuthStateChanged,
      signInWithCustomToken,
      signInAnonymously
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    window.firebaseAuth = {
      getAuth,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      signOut,
      onAuthStateChanged,
      signInWithCustomToken,
      signInAnonymously
    };

    try {
      const firebaseConfig = JSON.parse(window.__firebase_config || '{}');
      const app = initializeApp(firebaseConfig);
      window.auth = getAuth(app);

      onAuthStateChanged(window.auth, user => {
        document.dispatchEvent(new CustomEvent('authStateChanged', { detail: { user } }));
      });

      if (window.__initial_auth_token) {
        await signInWithCustomToken(window.auth, window.__initial_auth_token);
      } else {
        await signInAnonymously(window.auth);
      }
    } catch (e) {
      console.error("Firebase initialization error:", e);
    }
  </script>

  <style>
    :root{
      --bg:#f4f4f4;
      --fg:#121212;
      --muted:#666;
      --ink:#222;
      --line:rgba(0,0,0,.08);
      --header-bg:#fff;
      --drawer-bg:rgba(0,0,0,.75);
      --hamSmall:13px;
      --hamBig:20px;
      --hamBigger:24px;
      --crestH:clamp(42px,6.3vw,74px);
      --containerPad:16px;
      --stickyBarTop:96px;
      --stickyTabsTop:140px;
    }
    body.light-theme{
      --bg:#0c0c0c;
      --fg:#f5f5f5;
      --muted:#b3b3b3;
      --ink:#f5f5f5;
      --line:rgba(255,255,255,.1);
      --header-bg:#000;
      --drawer-bg:rgba(10,10,10,.85);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    body{
      background:var(--bg);
      color:var(--fg);
      font-family:Oswald,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      transition:background-color .3s,color .3s;
    }
    a{color:inherit;text-decoration:none}
    .container{max-width:1200px;margin:0 auto;padding:0 var(--containerPad)}

    /* HEADER / TOPBAR */
    .header{position:sticky;top:0;z-index:50;background:var(--header-bg);box-shadow:0 1px 0 var(--line);}
    .topbar{display:flex;align-items:center;justify-content:space-between;padding:8px 0}
    .left-icons{display:flex;align-items:center;gap:8px}
    .icon-btn{
      background:none;border:none;color:var(--fg);opacity:.92;
      display:inline-flex;align-items:center;justify-content:center;
      padding:0;margin:0 2px;cursor:pointer;
    }
    .icon-btn i{font-size:20px}
    .topnav{display:flex;gap:18px;align-items:center}
    .nav-pair{white-space:nowrap}
    .nav-pair .thin{
      font:300 var(--hamSmall) Oswald,sans-serif;
      letter-spacing:.02em;
      color:#cfd2d6;
      margin-right:2px;
    }
    body.light-theme .nav-pair .thin{color:var(--muted)}
    .nav-pair .bold{
      font:400 var(--hamSmall) "Bebas Neue",sans-serif;
      letter-spacing:.09em;
    }
    .wordmark-wrap{
      display:flex;align-items:center;justify-content:flex-end;min-width:120px;
    }
    .wordmark-img{
      height:clamp(18px,3.2vw,28px);width:auto;display:block;
    }
    body.light-theme .wordmark-img{filter:invert(1)}
    @media (max-width:1100px){.topnav{display:none}}

    .hr-y{border-top:1px solid var(--line);}

    /* SCHOOL BANNER (match card page, tighter tracking) */
    .schoolrow{
      display:flex;align-items:center;gap:12px;
      padding:6px var(--containerPad);
    }
    .ham-logo{
      height:var(--crestH);width:auto;object-fit:contain;display:block;flex-shrink:0;
    }
    .schooltext{line-height:1}
    .schooltext .small{
      font:300 var(--hamSmall)/1 Oswald;
      letter-spacing:.22em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .schooltext .big1{
      font:400 var(--hamBig)/1 "Bebas Neue",sans-serif;
      letter-spacing:.11em;
    }
    .schooltext .big2{
      font:400 var(--hamBigger)/1 "Bebas Neue",sans-serif;
      letter-spacing:.11em;
      margin-top:-2px;
    }

    /* HERO (same as card back) */
    .hero{padding:6px 0 8px}
    .hero-grid{
      display:flex;align-items:center;justify-content:space-between;gap:16px;
    }
    .hero-left{
      font:300 13px Oswald,sans-serif;
      letter-spacing:.22em;
      text-transform:uppercase;
    }
    .hero-left .bold-word{
      font-family:"Bebas Neue",sans-serif;
      letter-spacing:.16em;
    }
    .hero-right{display:flex;gap:12px;align-items:center;}
    .hero-icon i{font-size:20px;}

    @media (max-width:768px){
      .hero-grid{flex-direction:row;align-items:center;}
    }

    /* DRAWER */
    body.drawer-open{overflow:hidden}
    .drawer-mask{
      position:fixed;inset:0;
      background:rgba(0,0,0,.35);
      opacity:0;
      pointer-events:none;
      transition:opacity .2s;
      z-index:60;
    }
    .drawer{
      position:fixed;top:0;bottom:0;left:0;
      width:min(340px,80vw);
      background:var(--drawer-bg);
      color:#fff;
      transform:translateX(-110%);
      transition:transform .25s;
      z-index:70;
      display:flex;
      flex-direction:column;
    }
    body.drawer-open .drawer-mask{opacity:1;pointer-events:auto}
    body.drawer-open .drawer{transform:translateX(0)}
    .drawer-header{
      display:flex;justify-content:space-between;align-items:center;
      padding:16px;
      border-bottom:1px solid rgba(255,255,255,.12);
    }
    .drawer-title{
      font:400 20px "Bebas Neue",sans-serif;
      letter-spacing:.12em;
      text-transform:uppercase;
    }
    .drawer-content{flex:1;overflow-y:auto;padding:0 16px 16px;}
    .drawer-subhead{
      font:400 16px "Bebas Neue",sans-serif;
      letter-spacing:.12em;
      margin:18px 0 8px;
      text-transform:uppercase;
    }
    #playerSearch{
      width:100%;
      padding:10px 12px;
      border-radius:999px;
      border:none;
      outline:none;
      background:rgba(255,255,255,.12);
      color:#fff;
      font-size:14px;
    }
    #liveResults{margin-top:10px;}
    .live-hit{
      display:flex;gap:10px;align-items:center;
      padding:8px 6px;
      border-radius:10px;
      cursor:pointer;
    }
    .live-hit:hover{background:rgba(255,255,255,.08);}
    .live-hit img{
      width:42px;height:42px;border-radius:6px;object-fit:cover;flex-shrink:0;
    }
    .live-hit-main{font-size:14px;font-weight:600;}
    .live-hit-sub{font-size:12px;opacity:.75;}

    .drawer-nav-item{
      display:block;
      margin-bottom:10px;
    }

    /* PROFILE HERO CARD – clone of card back */
    main{padding:0 0 80px;}
    .profile-shell{max-width:1200px;margin:0 auto;padding:0 var(--containerPad);}
    .profile-card{
      margin-top:0;
      background:#fff;
      border-radius:18px;
      box-shadow:0 10px 30px rgba(0,0,0,.08);
      padding:18px 18px 24px;
    }
    body.light-theme .profile-card{
      background:#111;
      box-shadow:0 10px 30px rgba(0,0,0,.55);
    }
    .profile-main{
      display:grid;
      grid-template-columns:minmax(0,1.1fr) minmax(0,0.9fr);
      gap:18px;
      align-items:flex-start;
    }
    @media (max-width:768px){
      .profile-main{
        grid-template-columns:minmax(0,1fr);
      }
    }

    .profile-info{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .profile-name{
      font:400 32px "Bebas Neue",sans-serif;
      letter-spacing:.12em;
      text-transform:uppercase;
    }
    .profile-teamline{
      font-size:14px;
      text-transform:uppercase;
      letter-spacing:.12em;
      color:var(--muted);
    }
    .profile-meta{
      font-size:13px;
      line-height:1.4;
    }
    .profile-meta strong{font-weight:700;}
    .profile-line{margin-top:2px;}

    .profile-photo-wrap{
      position:relative;
      border-radius:18px;
      overflow:hidden;
      box-shadow:0 14px 30px rgba(0,0,0,.18);
      background:#000;
      max-width:260px;
      margin-left:auto;
    }
    .profile-photo-wrap img{
      display:block;
      width:100%;
      height:auto;
      aspect-ratio:5 / 7;
      object-fit:cover;
    }

    /* STICKY MINI BAR (collapsed player) */
    .profile-sticky-bar{
      position:sticky;
      top:var(--stickyBarTop);
      z-index:40;
      background:var(--header-bg);
      border-bottom:1px solid var(--line);
      padding:6px var(--containerPad);
      display:none;
    }
    .profile-sticky-bar.is-visible{display:block;}
    .profile-sticky-bar-inner{
      max-width:1200px;
      margin:0 auto;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .profile-sticky-thumb{
      width:38px;height:38px;border-radius:10px;overflow:hidden;flex-shrink:0;
      box-shadow:0 6px 16px rgba(0,0,0,.25);
      background:#000;
    }
    .profile-sticky-thumb img{
      width:100%;height:100%;object-fit:cover;
    }
    .profile-sticky-text{
      flex:1;
      min-width:0;
    }
    .profile-sticky-name{
      font:400 18px "Bebas Neue",sans-serif;
      letter-spacing:.15em;
      text-transform:uppercase;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .profile-sticky-sub{
      font-size:11px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:var(--muted);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .profile-sticky-fav{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:1px;
      font-size:9px;
      letter-spacing:.15em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .profile-sticky-fav button{
      border:none;
      background:none;
      cursor:pointer;
      font-size:18px;
      line-height:1;
    }
    .profile-sticky-fav button.is-favorite{color:#facc15;}

    /* FUN ZONE TABS – clone of card back, sticky */
    .tabs-wrapper{
      position:sticky;
      top:var(--stickyTabsTop);
      z-index:30;
      background:var(--bg);
      padding:0 0 6px;
      border-bottom:1px solid var(--line);
    }
    .tabs-inner{
      max-width:1200px;
      margin:0 auto;
      padding:0 var(--containerPad);
    }
    .tabs-row{
      display:flex;
      justify-content:space-between;
      gap:4px;
    }
    .tab-btn{
      flex:1;
      padding:6px 2px 8px;
      border:none;
      background:none;
      cursor:pointer;
      font:400 11px "Bebas Neue",sans-serif;
      letter-spacing:.10em;
      text-transform:uppercase;
      color:var(--muted);
      border-bottom:3px solid transparent;
      text-align:center;
      line-height:1.25;
      white-space:normal;
    }
    .tab-btn.active{
      color:var(--fg);
      border-bottom-color:var(--fg);
    }

    /* TAB PANELS */
    .tab-panels{
      max-width:1200px;
      margin:0 auto;
      padding:10px var(--containerPad) 80px;
    }
    .tab-panel{display:none;}
    .tab-panel.active{display:block;}

    /* STATS GRID */
    .stats-block{
      margin-bottom:18px;
      background:#fff;
      border-radius:14px;
      box-shadow:0 8px 18px rgba(0,0,0,.06);
      padding:14px 14px 12px;
    }
    body.light-theme .stats-block{
      background:#111;
      box-shadow:0 8px 18px rgba(0,0,0,.55);
    }
    .stats-header-row{
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      margin-bottom:10px;
    }
    .stats-heading{
      font:400 14px "Bebas Neue",sans-serif;
      letter-spacing:.14em;
      text-transform:uppercase;
    }
    .stats-subline{
      font:300 11px Oswald,sans-serif;
      letter-spacing:.16em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .stats-grid{
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:8px;
    }
    @media (max-width:600px){
      .stats-grid{
        grid-template-columns:repeat(3,1fr);
      }
    }
    .stat-tile{
      border-radius:10px;
      background:var(--line);
      padding:6px 4px;
      text-align:center;
    }
    .stat-label{
      font-size:11px;
      text-transform:uppercase;
      opacity:.7;
    }
    .stat-value{
      font-size:18px;
      font-weight:700;
      margin-top:2px;
    }

    /* NEWS */
    .news-card{
      background:#fff;
      border-radius:14px;
      box-shadow:0 8px 18px rgba(0,0,0,.06);
      padding:10px;
      display:flex;
      gap:10px;
      margin-bottom:10px;
    }
    body.light-theme .news-card{
      background:#111;
      box-shadow:0 8px 18px rgba(0,0,0,.55);
    }
    .news-thumb{
      width:84px;height:64px;border-radius:10px;overflow:hidden;flex-shrink:0;background:#000;
    }
    .news-thumb img{width:100%;height:100%;object-fit:cover;}
    .news-main{flex:1;min-width:0;}
    .news-title{
      font-weight:700;
      font-size:14px;
      margin-bottom:4px;
    }
    .news-meta{
      font-size:11px;
      opacity:.75;
      margin-bottom:6px;
    }
    .news-recap{
      font-size:13px;
      line-height:1.4;
    }

    /* SOCIAL */
    .social-section{
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .social-pill-row{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    .social-pill{
      padding:8px 12px;
      border-radius:999px;
      border:1px solid var(--line);
      font-size:13px;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .social-pill i{font-size:16px;}
    .social-note{font-size:13px;opacity:.8;}

    /* MENTORSHIP */
    .mm-card{
      background:#fff;
      border-radius:14px;
      box-shadow:0 8px 18px rgba(0,0,0,.06);
      padding:14px 14px 18px;
    }
    body.light-theme .mm-card{
      background:#111;
      box-shadow:0 8px 18px rgba(0,0,0,.55);
    }
    .mm-title{
      font:400 16px "Bebas Neue",sans-serif;
      letter-spacing:.14em;
      text-transform:uppercase;
      margin-bottom:6px;
    }
    .mm-body{font-size:14px;line-height:1.5;margin-bottom:10px;}
    .mm-options{margin-bottom:10px;font-size:13px;}
    .mm-cta-btn{
      padding:10px 16px;
      border-radius:999px;
      border:none;
      background:var(--fg);
      color:var(--bg);
      font:400 14px "Bebas Neue",sans-serif;
      letter-spacing:.16em;
      text-transform:uppercase;
      cursor:pointer;
    }

    /* GALLERY */
    .gallery-shell{
      background:#fff;
      border-radius:14px;
      box-shadow:0 8px 18px rgba(0,0,0,.06);
      padding:12px;
    }
    body.light-theme .gallery-shell{
      background:#111;
      box-shadow:0 8px 18px rgba(0,0,0,.55);
    }
    .carousel{
      position:relative;
      overflow:hidden;
      border-radius:14px;
    }
    .carousel-track{
      display:flex;
      transition:transform .35s ease;
    }
    .carousel-slide{
      min-width:100%;
      max-height:300px;
    }
    .carousel-slide img{
      width:100%;height:100%;object-fit:cover;display:block;
    }
    .carousel-arrow{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      width:34px;height:34px;
      border-radius:50%;
      border:none;
      background:rgba(0,0,0,.55);
      color:#fff;
      display:flex;align-items:center;justify-content:center;
      cursor:pointer;
    }
    .carousel-arrow.left{left:8px;}
    .carousel-arrow.right{right:8px;}
    .gallery-caption{
      font-size:12px;
      margin-top:8px;
      opacity:.85;
    }
    .gallery-upload-note{
      margin-top:10px;
      font-size:13px;
    }
    .upload-link{
      text-decoration:underline;
      cursor:pointer;
    }

    /* MODAL FOR SUPERFAN CTA */
    .modal-mask{
      position:fixed;inset:0;
      background:rgba(0,0,0,.5);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:90;
    }
    .modal-mask.is-open{display:flex;}
    .modal-dialog{
      max-width:380px;width:90%;
      background:#fff;
      border-radius:16px;
      padding:18px 18px 16px;
      box-shadow:0 18px 40px rgba(0,0,0,.4);
    }
    body.light-theme .modal-dialog{
      background:#111;
    }
    .modal-title{
      font:400 18px "Bebas Neue",sans-serif;
      letter-spacing:.14em;
      text-transform:uppercase;
      margin-bottom:8px;
    }
    .modal-body{font-size:14px;line-height:1.5;margin-bottom:12px;}
    .modal-price{font-weight:700;margin-bottom:10px;}
    .modal-actions{
      display:flex;
      gap:8px;
      justify-content:flex-end;
      flex-wrap:wrap;
    }
    .btn-outline{
      padding:8px 12px;
      border-radius:999px;
      border:1px solid var(--fg);
      background:none;
      font:400 13px "Bebas Neue",sans-serif;
      letter-spacing:.12em;
      text-transform:uppercase;
      cursor:pointer;
    }
    .btn-solid{
      padding:8px 12px;
      border-radius:999px;
      border:none;
      background:var(--fg);
      color:var(--bg);
      font:400 13px "Bebas Neue",sans-serif;
      letter-spacing:.12em;
      text-transform:uppercase;
      cursor:pointer;
    }

    /* FOOTER SPONSOR */
    .site-footer{
      position:fixed;
      left:0;right:0;bottom:0;
      height:60px;
      background:var(--bg);
      border-top:1px solid var(--line);
      z-index:20;
    }
    .site-footer img{
      width:100%;height:100%;object-fit:contain;
    }
  </style>
</head>

<body>
  <!-- LEFT DRAWER -->
  <div class="drawer-mask"></div>
  <aside class="drawer" id="drawerLeft" aria-label="Navigation & search">
    <div class="drawer-header">
      <div class="drawer-title">PLAYER PROFILE SEARCH</div>
      <button class="icon-btn" id="drawerClose"><i class="ri-close-line"></i></button>
    </div>
    <div class="drawer-content">
      <input id="playerSearch" placeholder="Type to search…" />
      <div id="liveResults"></div>

      <div class="drawer-subhead">Navigation</div>
      <nav>
        <a href="index.html" class="drawer-nav-item nav-pair">
          <span class="thin">WHERE THEY</span><span class="bold">YAT?</span>
        </a>
        <a href="alumni-news.html" class="drawer-nav-item nav-pair">
          <span class="thin">ACTIVE ALUMNI</span><span class="bold">NEWS</span>
        </a>
        <a href="current-team.html" class="drawer-nav-item nav-pair">
          <span class="thin">THE</span><span class="bold">CURRENT TEAM</span>
        </a>
        <a href="marketplace.html" class="drawer-nav-item nav-pair">
          <span class="thin">MENTORSHIP</span><span class="bold">MARKETPLACE</span>
        </a>
        <a href="all-time-list.html" class="drawer-nav-item nav-pair">
          <span class="thin">NEXT-LEVEL</span><span class="bold">ALL-TIME LIST</span>
        </a>
        <a href="partner-program.html" class="drawer-nav-item nav-pair">
          <span class="thin">PCD ACTION</span><span class="bold">PARTNER PROGRAM</span>
        </a>
        <a href="faq.html" class="drawer-nav-item nav-pair">
          <span class="bold">FAQ’S</span>
        </a>
      </nav>
    </div>
  </aside>

  <!-- HEADER -->
  <header class="header">
    <div class="container topbar">
      <div class="left-icons">
        <button class="icon-btn" id="btnMenu" aria-label="Menu">
          <i class="ri-menu-line"></i>
        </button>
        <button class="icon-btn" id="btnAccount" aria-label="Account">
          <i class="ri-user-3-line"></i>
        </button>
        <button class="icon-btn" id="theme-toggle" aria-label="Toggle Theme">
          <i class="ri-sun-line"></i>
        </button>
      </div>

      <nav class="topnav" aria-label="Top Navigation">
        <a href="index.html" class="nav-pair">
          <span class="thin">WHERE THEY</span><span class="bold">YAT?</span>
        </a>
        <a href="alumni-news.html" class="nav-pair">
          <span class="thin">ACTIVE ALUMNI</span><span class="bold">NEWS</span>
        </a>
        <a href="current-team.html" class="nav-pair">
          <span class="thin">THE</span><span class="bold">CURRENT TEAM</span>
        </a>
        <a href="marketplace.html" class="nav-pair">
          <span class="thin">MENTORSHIP</span><span class="bold">MARKETPLACE</span>
        </a>
        <a href="all-time-list.html" class="nav-pair">
          <span class="thin">NEXT-LEVEL</span><span class="bold">ALL-TIME LIST</span>
        </a>
        <a href="partner-program.html" class="nav-pair">
          <span class="thin">PCD ACTION</span><span class="bold">PARTNER PROGRAM</span>
        </a>
        <a href="faq.html" class="nav-pair">
          <span class="bold">FAQ’S</span>
        </a>
      </nav>

      <div class="wordmark-wrap">
        <img src="assets/img/yatstats-logo.png" alt="YAT?STATS" class="wordmark-img">
      </div>
    </div>

    <div class="hr-y"></div>

    <!-- SCHOOL BANNER -->
    <div class="container schoolrow">
      <img src="assets/img/schools/hamilton.az.png" alt="Hamilton H" class="ham-logo"
           onerror="this.onerror=null;this.src='assets/img/placeholder.png';">
      <div class="schooltext">
        <div class="small">CHANDLER, AZ</div>
        <div class="big1">HAMILTON HIGH SCHOOL</div>
        <div class="big2">ACTIVE BASEBALL ALUMNI</div>
      </div>
    </div>

    <div class="hr-y"></div>

    <!-- HERO ROW (FLIP FOR STATS!) -->
    <section class="hero">
      <div class="container hero-grid">
        <div class="hero-left">
          FLIP FOR <span class="bold-word">STATS!</span>
        </div>
        <div class="hero-right">
          <button id="openSearch" class="hero-icon icon-btn" aria-label="Search players">
            <i class="ri-search-line"></i>
          </button>
          <button class="hero-icon icon-btn" aria-label="Filters (placeholder)">
            <i class="ri-equalizer-line"></i>
          </button>
          <button class="hero-icon icon-btn" aria-label="Reset (placeholder)">
            <i class="ri-refresh-line"></i>
          </button>
        </div>
      </div>
    </section>
  </header>

  <!-- STICKY MINI BAR (collapsed player) -->
  <div class="profile-sticky-bar" id="profileStickyBar">
    <div class="profile-sticky-bar-inner">
      <div class="profile-sticky-thumb"><img src="" alt="" id="stickyThumb"></div>
      <div class="profile-sticky-text">
        <div class="profile-sticky-name" id="stickyName">PLAYER NAME</div>
        <div class="profile-sticky-sub" id="stickySub">TEAM • LEVEL • STATUS</div>
      </div>
      <div class="profile-sticky-fav">
        <button class="fav-toggle" id="favToggleSticky" aria-label="Mark as favorite player">
          <i class="ri-star-line"></i>
        </button>
        <span>FAN FAVORITE</span>
      </div>
    </div>
  </div>

  <!-- MAIN PROFILE CONTENT -->
  <main>
    <div class="profile-shell">
      <section class="profile-card" id="profileMain">
        <div class="profile-main" id="profileHeroBlock">
          <div class="profile-info">
            <div class="profile-teamline" id="crumbLine">HAMILTON ▸ PLAYER</div>
            <div class="profile-name" id="playerNameHeading">PLAYER NAME</div>
            <div class="profile-teamline" id="teamLine">Team • Level • Status</div>
            <div class="profile-meta" id="playerMetaPrimary"></div>
            <div class="profile-meta" id="playerMetaSecondary"></div>
          </div>
          <div class="profile-photo-wrap">
            <img src="" alt="Player photo" id="playerPhoto">
          </div>
        </div>
      </section>
    </div>

    <!-- FUN ZONE TABS (sticky) -->
    <div class="tabs-wrapper">
      <div class="tabs-inner">
        <div class="tabs-row" role="tablist">
          <button class="tab-btn active" data-tab="stats">SEASON & CAREER STATISTICS</button>
          <button class="tab-btn" data-tab="news">NEWS & VIDEO CLIPS</button>
          <button class="tab-btn" data-tab="social">SOCIAL MEDIA FEEDS</button>
          <button class="tab-btn" data-tab="mentor">YAT?STATS MENTORSHIP MARKETPLACE</button>
          <button class="tab-btn" data-tab="gallery">TIMELINE PHOTO GALLERY</button>
        </div>
      </div>
    </div>

    <!-- TAB PANELS -->
    <div class="tab-panels">
      <section class="tab-panel active" id="panel-stats"></section>
      <section class="tab-panel" id="panel-news"></section>
      <section class="tab-panel" id="panel-social"></section>
      <section class="tab-panel" id="panel-mentor"></section>
      <section class="tab-panel" id="panel-gallery"></section>
    </div>
  </main>

  <!-- SUPERFAN MODAL (kept simple) -->
  <div class="modal-mask" id="superfanModal">
    <div class="modal-dialog">
      <div class="modal-title">SUPERFAN SUBSCRIPTION</div>
      <div class="modal-body" id="superfanModalBody">
        Congratulations! Once your SuperFan transaction is completed the players you follow will be loaded onto your dashboard.
      </div>
      <div class="modal-price">
        SuperFan Access: <span id="superfanPrice">$9.99 / month</span>
      </div>
      <div class="modal-actions">
        <button class="btn-outline" id="superfanLaterBtn">Maybe Later</button>
        <button class="btn-solid" id="superfanCheckoutBtn">ADD TO CART</button>
      </div>
    </div>
  </div>

  <!-- FOOTER SPONSOR -->
  <footer class="site-footer">
    <a href="https://www.flowpage.com/petedeluca" target="_blank" rel="noopener noreferrer">
      <img src="assets/img/partners/american_banner.png" alt="American Solutions for Business">
    </a>
  </footer>

  <script type="module">
    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQcWJM6Q6hTdFnES_G5LUy4teCS-sJ5HdAc9F5HSY8DGE9egdGy8yUAe2ShT3tFm-CwUuCYeAYy_YiW/pub?gid=2028135390&output=csv";

    /* ---------- THEME ---------- */
    function applyThemeFromStorage(){
      const saved = localStorage.getItem('theme');
      const body = document.body;
      const icon = $('#theme-toggle i');
      if(saved === 'light'){
        body.classList.add('light-theme');
        icon?.classList.replace('ri-sun-line','ri-moon-line');
      }else{
        body.classList.remove('light-theme');
        icon?.classList.replace('ri-moon-line','ri-sun-line');
      }
    }
    $('#theme-toggle')?.addEventListener('click', ()=>{
      const body = document.body;
      body.classList.toggle('light-theme');
      localStorage.setItem('theme', body.classList.contains('light-theme') ? 'light' : 'dark');
      applyThemeFromStorage();
    });
    applyThemeFromStorage();

    /* ---------- DRAWER ---------- */
    function openDrawer(){
      document.body.classList.add('drawer-open');
    }
    function closeDrawer(){
      document.body.classList.remove('drawer-open');
    }
    $('#btnMenu')?.addEventListener('click', openDrawer);
    $('#openSearch')?.addEventListener('click', openDrawer);
    $('#drawerClose')?.addEventListener('click', closeDrawer);
    $('.drawer-mask')?.addEventListener('click', closeDrawer);

    /* ---------- LOGIN PLACEHOLDER ---------- */
    $('#btnAccount')?.addEventListener('click', ()=>{
      alert('Login / SuperFan dashboard drawer will live here in the full app. For now this just confirms the icon is wired.');
    });

    /* ---------- SLUG / CSV HELPERS ---------- */
    function slugOf(p){
      if(!p) return '';
      const s=(p.slug||'').trim();
      if(s) return s;
      return (p.display_name||'').trim().toLowerCase().replace(/[^a-z0-9]+/g,'-');
    }
    function imageNameOf(p){
      const statusUpper=(p.status||'').toUpperCase();
      const isSponsor = statusUpper === 'SPONSOR' || statusUpper === 'RETIRED-SPONSOR';
      if(isSponsor && p.slug){
        return p.slug.trim().toLowerCase().replace(/\s+/g,'_').replace(/[^a-z0-9_]/g,'');
      }
      const first=(p.first||'').toLowerCase().replace(/\s+/g,'_');
      const last=(p.last||'').toLowerCase().replace(/\s+/g,'_');
      if(first || last) return [first,last].filter(Boolean).join('_');
      return (p.slug||p.display_name||'').toLowerCase().replace(/\s+/g,'_').replace(/[^a-z0-9_]/g,'');
    }

    async function loadCSV(url){
      const res = await fetch(url);
      if(!res.ok) throw new Error('CSV load failed: '+res.status);
      const text = await res.text();
      const rows = text.trim().split(/\r?\n/).map(
        line => line.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/).map(c => c.replace(/^"|"$/g,''))
      );
      const header = rows.shift().map(h => h.trim());
      const idx = name => header.indexOf(name);
      const statKeys = ['avg','obp','slg','ops','ab','h','r','rbi','2b','3b','hr','sb','bb','era','k/9','k/bb','whip','ip','er','ko','gp','w-l','saves','fip'];

      return rows.map(r=>{
        const player = {
          slug:r[idx('slug')],
          display_name:r[idx('display_name')],
          first:r[idx('first')],
          last:r[idx('last')],
          grad_class:r[idx('grad_class')],
          letter_years:r[idx('letter_years')],
          status:r[idx('status')],
          level:r[idx('level')],
          team:r[idx('team')],
          org:r[idx('org')],
          position:r[idx('position')],
          height:r[idx('height')],
          weight:r[idx('weight')],
          bats:r[idx('bats')],
          throws:r[idx('throws')],
          draft_info:r[idx('Draft_Info')] ?? r[idx('draft_info')],
          colleges:r[idx('Colleges')] ?? r[idx('colleges')],
          next_game_date:r[idx('next_game_date')],
          next_game_time:r[idx('next_game_time')],
          next_game_opponent:r[idx('next_game_opponent')],
          next_game_datetime:r[idx('next_game_datetime')],
          last_game_1:r[idx('last_game_1')],
          last_game_2:r[idx('last_game_2')],
          last_game_3:r[idx('last_game_3')],
          x_handle:r[idx('x_handle')],
          ig_handle:r[idx('ig_handle')],
          video_url:r[idx('video_url')],
          nil_score:r[idx('nil_score')],
          stats:{}
        };
        for(const key of statKeys){
          const sIdx = idx(key);
          if(sIdx > -1 && r[sIdx]) player.stats[key.toUpperCase()] = r[sIdx];
        }
        return player;
      });
    }

    function formatStatValue(key,value){
      if(!value || value === '--') return '--';
      const decimalStats=['AVG','OBP','SLG','OPS'];
      if(decimalStats.includes(key.toUpperCase())){
        const num=parseFloat(value);
        if(isNaN(num)) return value;
        const str=num.toFixed(3);
        return (num<1 && num>-1) ? str.substring(1) : str;
      }
      return value;
    }

    /* ---------- PLAYER SEARCH IN DRAWER ---------- */
    function makeHit(p){
      const el=document.createElement('div');
      el.className='live-hit';
      const imageName=imageNameOf(p);
      const hsImgJpg=`assets/img/hs_players/${imageName}.jpg`;
      const hsImgPng=`assets/img/hs_players/${imageName}.png`;
      el.innerHTML=`
        <img src="${hsImgJpg}" onerror="this.onerror=null;this.src='${hsImgPng}'">
        <div>
          <div class="live-hit-main">${p.display_name}</div>
          <div class="live-hit-sub">${p.level||''} • Class of ${p.grad_class||''}</div>
        </div>`;
      el.onclick=()=>{
        window.location.href = 'profile.html?player='+encodeURIComponent(slugOf(p));
      };
      return el;
    }
    function setupSearch(players){
      const searchInput = $('#playerSearch');
      const liveResults = $('#liveResults');
      if(!searchInput || !liveResults) return;

      searchInput.addEventListener('input', ()=>{
        const q = searchInput.value.trim().toLowerCase();
        liveResults.innerHTML='';
        if(!q) return;
        const hits = players.filter(p => (p.display_name || '').toLowerCase().includes(q)).slice(0,25);
        hits.forEach(p => liveResults.appendChild(makeHit(p)));
      });
    }

    /* ---------- FAVORITES (LOCALSTORAGE ONLY) ---------- */
    function getFavSet(){
      try{
        const raw = localStorage.getItem('YAT_FAV_PLAYERS') || '[]';
        return new Set(JSON.parse(raw));
      }catch{ return new Set(); }
    }
    function saveFavSet(set){
      localStorage.setItem('YAT_FAV_PLAYERS', JSON.stringify(Array.from(set)));
    }
    function wireFavToggles(slug){
      const favSet = getFavSet();
      const stickyBtn = $('#favToggleSticky');

      const updateUI = ()=>{
        const isFav = favSet.has(slug);
        if(!stickyBtn) return;
        stickyBtn.classList.toggle('is-favorite', isFav);
        const icon = stickyBtn.querySelector('i');
        if(icon){
          icon.className = isFav ? 'ri-star-fill' : 'ri-star-line';
        }
      };
      updateUI();

      const toggle = ()=>{
        if(favSet.has(slug)) favSet.delete(slug); else favSet.add(slug);
        saveFavSet(favSet);
        updateUI();
      };
      stickyBtn?.addEventListener('click', toggle);
    }

    /* ---------- SUPERFAN CTA MODAL ---------- */
    function setupSuperfanModal(){
      const modal = $('#superfanModal');
      const laterBtn = $('#superfanLaterBtn');
      const checkoutBtn = $('#superfanCheckoutBtn');

      const open = ()=> modal.classList.add('is-open');
      const close = ()=> modal.classList.remove('is-open');

      // You can wire "open" to a SuperFan button later if you want.
      laterBtn?.addEventListener('click', close);
      modal?.addEventListener('click', e=>{
        if(e.target === modal) close();
      });
      checkoutBtn?.addEventListener('click', ()=>{
        alert('In the live site this will take the fan to a checkout screen (Stripe / GHL) and then unlock their SuperFan dashboard.');
        close();
      });
    }

    /* ---------- STICKY BAR / TABS ---------- */
    function updateStickyOffsets(){
      const header = document.querySelector('.header');
      const headerH = header ? header.offsetHeight : 96;
      const bar = $('#profileStickyBar');
      const barH = bar ? bar.offsetHeight : 52;
      document.documentElement.style.setProperty('--stickyBarTop', headerH + 'px');
      document.documentElement.style.setProperty('--stickyTabsTop', (headerH + barH) + 'px');
    }
    window.addEventListener('resize', updateStickyOffsets);

    function wireScrollSticky(){
      const heroBlock = $('#profileHeroBlock');
      const bar = $('#profileStickyBar');
      if(!heroBlock || !bar) return;

      const offsetTop = heroBlock.offsetTop;
      const height = heroBlock.offsetHeight;
      const threshold = offsetTop + height - 40;

      const onScroll = ()=>{
        if(window.scrollY > threshold){
          bar.classList.add('is-visible');
        }else{
          bar.classList.remove('is-visible');
        }
      };
      window.addEventListener('scroll', onScroll);
      onScroll();
    }

    function wireTabs(){
      const buttons = $$('.tab-btn');
      const panels = {
        stats: $('#panel-stats'),
        news: $('#panel-news'),
        social: $('#panel-social'),
        mentor: $('#panel-mentor'),
        gallery: $('#panel-gallery')
      };
      buttons.forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const tab = btn.dataset.tab;
          buttons.forEach(b=>b.classList.toggle('active', b===btn));
          Object.entries(panels).forEach(([key,p])=>{
            if(p) p.classList.toggle('active', key===tab);
          });
        });
      });
    }

    /* ---------- RENDER PROFILE ---------- */
    function renderProfile(player){
      const imgName = imageNameOf(player);
      const nowJpg = `assets/img/now_players/${imgName}.jpg`;
      const nowPng = `assets/img/now_players/${imgName}.png`;
      const photoEl = $('#playerPhoto');
      photoEl.src = nowJpg;
      photoEl.onerror = function(){
        this.onerror=null;
        this.src = nowPng;
      };

      const name = player.display_name || `${player.first||''} ${player.last||''}`.trim();
      $('#playerNameHeading').textContent = name;
      $('#crumbLine').textContent = `HAMILTON ▸ ${name}`;
      $('#teamLine').textContent = `${player.team||''} • ${player.level||''} • ${player.status||''}`.replace(/ ?• ?$/,'');
      $('#playerMetaPrimary').innerHTML =
        `<div class="profile-line"><strong>${player.org || ''}</strong></div>`+
        `<div class="profile-line">${player.position||''} | H: ${player.height||'--'} | W: ${player.weight||'--'} | B/T: ${player.bats||'--'}/${player.throws||'--'}</div>`;
      $('#playerMetaSecondary').innerHTML =
        `<div class="profile-line"><strong>Draft:</strong> ${player.draft_info || 'N/A'}</div>`+
        `<div class="profile-line"><strong>Colleges:</strong> ${player.colleges || 'N/A'}</div>`;

      // Sticky bar
      $('#stickyThumb').src = nowJpg;
      $('#stickyThumb').onerror = function(){
        this.onerror=null; this.src = nowPng;
      };
      $('#stickyName').textContent = name;
      $('#stickySub').textContent = `${player.team||''} • ${player.level||''} • ${player.status||''}`.replace(/ ?• ?$/,'');

      // Panels
      renderStatsPanel(player);
      renderNewsPanel(player);
      renderSocialPanel(player);
      renderMentorPanel(player);
      renderGalleryPanel(player);

      wireFavToggles(slugOf(player));
      setupSuperfanModal();
      wireTabs();
      updateStickyOffsets();
      wireScrollSticky();
    }

    function renderStatsPanel(player){
      const panel = $('#panel-stats');
      if(!panel) return;
      const batterStats=['AVG','OBP','SLG','OPS','H','R','HR','RBI','AB','2B','3B','SB'];
      const pitcherStats=['ERA','K/9','K/BB','WHIP','IP','ER','KO','BB','GP','W-L','SAVES','FIP'];
      const isPitcher = player.stats['ERA'] !== undefined;
      const statsToShow = isPitcher ? pitcherStats : batterStats;

      function makeGrid(label, subline){
        const tiles = statsToShow.map(stat=>{
          const v = formatStatValue(stat, player.stats[stat]);
          return `<div class="stat-tile">
                    <div class="stat-label">${stat}</div>
                    <div class="stat-value">${v ?? '--'}</div>
                  </div>`;
        }).join('');
        return `<div class="stats-block">
                  <div class="stats-header-row">
                    <div class="stats-heading">${label}</div>
                    ${subline ? `<div class="stats-subline">${subline}</div>` : ''}
                  </div>
                  <div class="stats-grid">${tiles}</div>
                </div>`;
      }

      let html = makeGrid('CAREER STATS','');

      const currentYear = new Date().getFullYear();
      const seasonSub = `${player.team || ''} • ${player.level || ''}`.replace(/ ?• ?$/,'');
      for(let i=0;i<3;i++){
        const year = currentYear - i;
        html += makeGrid(`${year} SEASON STATS`, seasonSub);
      }
      panel.innerHTML = html;
    }

    function renderNewsPanel(player){
      const panel = $('#panel-news');
      if(!panel) return;

      const cacheRaw = localStorage.getItem('YAT_NEWS_CACHE_V1');
      let items = [];
      try{
        const cache = cacheRaw ? JSON.parse(cacheRaw) : {};
        if(Array.isArray(cache.items)) items = cache.items;
      }catch{ items=[]; }

      const nameLc = (player.display_name || '').toLowerCase();
      const mine = items
        .filter(n => String(n.player_display_name||'').toLowerCase() === nameLc)
        .sort((a,b)=> new Date(b.publishedAt||0) - new Date(a.publishedAt||0))
        .slice(0,5);

      if(!mine.length){
        panel.innerHTML = `
          <div class="stats-block">
            <div class="stats-heading">LATEST HEADLINES</div>
            <p style="font-size:14px;text-align:center;opacity:.8;">
              No recent headlines found for ${player.display_name || 'this player'} yet. Check back soon!
            </p>
          </div>`;
        return;
      }

      const cards = mine.map(n=>{
        const img = n.image || ('https://picsum.photos/seed/'+encodeURIComponent(n.id||n.title||'news')+'/600/400');
        const when = n.publishedAt ? new Date(n.publishedAt).toLocaleString() : '';
        const src = n.source || 'News';
        const base = String(n.url || '#');
        const url = base + (base.includes('?') ? '&' : '?') + 'utm_source=yatstats&utm_medium=player_profile';
        const recap = `${player.first || player.display_name} keeps making noise at the next level. Full details in the article below – but Husky fans know this is the same energy we saw back in Chandler. YAT-A-BOY!`;
        return `
          <article class="news-card">
            <a href="${url}" target="_blank" rel="noopener" class="news-thumb">
              <img src="${img}" alt="">
            </a>
            <div class="news-main">
              <div class="news-title"><a href="${url}" target="_blank" rel="noopener">${n.title || 'Read more'}</a></div>
              <div class="news-meta">${src} • ${when}</div>
              <div class="news-recap">${recap}</div>
            </div>
          </article>`;
      }).join('');

      panel.innerHTML = `
        <div class="stats-block">
          <div class="stats-heading">LATEST HEADLINES</div>
          ${cards}
        </div>
      `;
    }

    function renderSocialPanel(player){
      const panel = $('#panel-social');
      if(!panel) return;

      const xHandle = (player.x_handle || '').replace(/^@/,'');
      const igHandle = (player.ig_handle || '').replace(/^@/,'');

      const lines = [];
      if(xHandle){
        lines.push(`
          <a class="social-pill" href="https://x.com/${xHandle}" target="_blank" rel="noopener">
            <i class="ri-twitter-x-line"></i><span>@${xHandle}</span>
          </a>`);
      }
      if(igHandle){
        lines.push(`
          <a class="social-pill" href="https://instagram.com/${igHandle}" target="_blank" rel="noopener">
            <i class="ri-instagram-line"></i><span>@${igHandle}</span>
          </a>`);
      }

      const video = player.video_url
        ? `<div style="margin-top:10px;">
             <div class="social-note" style="margin-bottom:4px;">Featured highlight clip</div>
             <iframe width="100%" height="220" src="${player.video_url}" title="Video highlight"
                     frameborder="0" allowfullscreen
                     style="border-radius:12px;"></iframe>
           </div>`
        : '';

      panel.innerHTML = `
        <div class="stats-block">
          <div class="stats-heading">SOCIAL MEDIA</div>
          <div class="social-section">
            <div class="social-pill-row">
              ${lines.length ? lines.join('') : '<div class="social-note">No social handles on file yet for this player.</div>'}
            </div>
            <div class="social-note">
              Tap a handle to view their latest posts. When you share, show them love with
              <strong>#YATABOY</strong> and tag <strong>@yat_stats</strong>.
            </div>
            ${video}
          </div>
        </div>`;
    }

    function renderMentorPanel(player){
      const panel = $('#panel-mentor');
      if(!panel) return;

      const name = player.display_name || player.first || 'this player';
      const firstName = (player.first || name).split(' ')[0];
      panel.innerHTML = `
        <div class="mm-card">
          <div class="mm-title">MENTORSHIP MARKETPLACE</div>
          <div class="mm-body">
            Upload your baseball video (hitting, throwing, fielding, etc.) and get personalized feedback,
            coaching, and encouragement from ${name}. We’ll route your request through the YAT?STATS
            Mentorship Marketplace so ${firstName} can reply with a custom video message.
          </div>
          <div class="mm-options">
            Example options (final pricing TBD):
            <ul style="margin:6px 0 0 18px;padding:0;font-size:13px;">
              <li>Quick “YAT-A-BOY!” shout-out</li>
              <li>Video breakdown of your swing or delivery</li>
              <li>Mentor message for your youth team</li>
            </ul>
          </div>
          <button class="mm-cta-btn">
            START A MENTORSHIP REQUEST
          </button>
          <div class="social-note" style="margin-top:8px;">
            For the MVP, this button can send fans to a dedicated Mentorship Marketplace page
            or a GHL-powered checkout flow. Later we can wire this directly to Stripe / ARMS
            and your SuperFan dashboards.
          </div>
        </div>
      `;
    }

    function renderGalleryPanel(player){
      const panel = $('#panel-gallery');
      if(!panel) return;

      const imgName = imageNameOf(player);
      const slides = [
        `assets/img/gallery/${imgName}_1.jpg`,
        `assets/img/gallery/${imgName}_2.jpg`,
        `assets/img/gallery/${imgName}_3.jpg`
      ];

      const slidesHtml = slides.map((src,i)=>`
        <div class="carousel-slide">
          <img src="${src}" alt="Timeline photo ${i+1} for ${player.display_name || 'player'}"
               onerror="this.onerror=null;this.src='assets/img/placeholder.png';">
        </div>
      `).join('');

      panel.innerHTML = `
        <div class="gallery-shell">
          <div class="carousel" id="timelineCarousel">
            <div class="carousel-track">
              ${slidesHtml}
            </div>
            <button class="carousel-arrow left" aria-label="Previous photo"><i class="ri-arrow-left-s-line"></i></button>
            <button class="carousel-arrow right" aria-label="Next photo"><i class="ri-arrow-right-s-line"></i></button>
          </div>
          <div class="gallery-caption">
            Swipe or tap the arrows to follow ${player.display_name || 'this player'} from youth days
            to the pros.
          </div>
          <div class="gallery-upload-note">
            Have a great photo with ${player.display_name || 'this player'}?
            <span class="upload-link" id="uploadLink">Tap here</span> to email it in with the year and a short memory.
            Captains will review and add the best pics to this timeline.
          </div>
        </div>
      `;

      const carousel = $('#timelineCarousel');
      if(!carousel) return;
      const track = carousel.querySelector('.carousel-track');
      const slidesEls = Array.from(carousel.querySelectorAll('.carousel-slide'));
      const prevBtn = carousel.querySelector('.carousel-arrow.left');
      const nextBtn = carousel.querySelector('.carousel-arrow.right');
      let index = 0;
      const goTo = (i)=>{
        if(!slidesEls.length) return;
        index = (i + slidesEls.length) % slidesEls.length;
        track.style.transform = `translateX(-${index*100}%)`;
      };
      prevBtn?.addEventListener('click', ()=>goTo(index-1));
      nextBtn?.addEventListener('click', ()=>goTo(index+1));

      $('#uploadLink')?.addEventListener('click', ()=>{
        const subject = encodeURIComponent(`Fan photo for ${player.display_name || 'Hamilton alum'}`);
        const body = encodeURIComponent(
          `Hi YAT?STATS,\n\nI have a photo for the ${player.display_name || 'player'} timeline gallery.\n\nApprox year:\nStory / memory:\n\n(Attach the photo before sending.)\n\nThanks!`
        );
        window.location.href = `mailto:fanpics@yatstats.com?subject=${subject}&body=${body}`;
      });
    }

    /* ---------- AUTH LOGGING (minimal) ---------- */
    (function setupAuth(){
      if(!window.firebaseAuth || !window.auth) return;
      document.addEventListener('authStateChanged', ({detail})=>{
        console.log('Auth state (profile page):', detail.user?.uid ? 'signed in' : 'anon');
      });
    })();

    /* ---------- BOOT ---------- */
    (async function init(){
      try{
        const params = new URLSearchParams(location.search);
        const slugParam = params.get('player');
        const players = await loadCSV(CSV_URL);
        window.__PLAYERS = players;
        setupSearch(players);

        const player = players.find(p => slugOf(p) === slugParam) || players[0];
        if(!player){
          $('#profileMain').innerHTML =
            '<p style="padding:18px;font-size:14px;">Player not found.</p>';
          return;
        }

        renderProfile(player);
      }catch(err){
        console.error(err);
        $('#profileMain').innerHTML =
          '<p style="padding:18px;font-size:14px;">Error loading player profile.</p>';
      }
    })();
  </script>
</body>
</html>