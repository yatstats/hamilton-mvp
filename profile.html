<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PLAYER PROFILE • Hamilton YAT?STATS</title>

<link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400&family=Bebas+Neue&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#f4f4f4; --fg:#121212; --muted:#777; --ink:#222; --line:rgba(0,0,0,.12);
  --card-bg:#ffffff; --header-bg:#ffffff; --drawer-bg:#111;
  --containerPad:16px; --footerH:clamp(56px,8vh,77px);
  --hamSmall:13px; --hamBig:20px; --hamBigger:24px;
}
body.dark-theme{
  --bg:#0c0c0c; --fg:#f2f2f2; --muted:#c4c4c4; --ink:#e8e8e8; --line:rgba(255,255,255,.12);
  --card-bg:#171717; --header-bg:#000; --drawer-bg:#111;
}
*{box-sizing:border-box} html,body{margin:0}
body{
  background:var(--bg);color:var(--fg);
  font-family:Oswald,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  transition:background-color .3s,color .3s;
}
a{color:inherit;text-decoration:none}

/* Layout */
.container{max-width:1400px;margin:0 auto;padding:0 var(--containerPad)}
.header{position:sticky;top:0;z-index:50;background:var(--header-bg);transition:background-color .3s;}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:8px 0}
.left-icons,.right-icons{display:flex;gap:8px;align-items:center}
/* move hamburger row so it aligns with page content */
.left-icons{padding-left:var(--containerPad);}
.icon-btn{background:none;border:none;color:var(--fg);opacity:.92;display:inline-flex;align-items:center;justify-content:center;padding:0;margin:0 2px;cursor:pointer}
.icon-btn i{font-size:20px}
.topnav{display:flex;gap:18px;align-items:center}
.nav-pair .thin{font:300 var(--hamSmall) Oswald; letter-spacing:.02em; color:#888; margin-right:2px}
.nav-pair .bold{font:400 var(--hamSmall) "Bebas Neue",sans-serif}
@media (max-width:1200px){ .topnav{display:none !important} }
.hr-y{border-top:1px solid var(--line);transition:border-color .3s;}

/* Breadcrumb + star */
.crumbs{font:300 calc(var(--hamSmall)*.8)/1 Oswald;color:var(--muted);text-transform:uppercase;white-space:nowrap;transition:color .3s;}
.crumb-player-name{font-weight:400;color:var(--fg);}
.crumb-star{
  background:none;border:none;cursor:pointer;
  color:var(--muted);
  display:inline-flex;align-items:center;justify-content:center;
  padding:0 0 0 4px;
}
.crumb-star i{font-size:15px;}
.crumb-star.active{color:#f9d35b;}

/* SCHOOL BANNER – match the list page header */
.school-banner{
  background:#ffffff;
  border-bottom:1px solid #e4e4e4;
}
.school-banner-inner{
  display:flex;align-items:center;gap:14px;
  padding:10px var(--containerPad) 8px;
}
.school-logo{
  width:62px;height:auto;flex:0 0 62px;
}
.school-banner-text{line-height:1.1}
.school-location{
  font:300 12px Oswald;
  letter-spacing:.12em;
  text-transform:uppercase;
  color:#999;
}
.school-name{
  font:700 20px "Bebas Neue",sans-serif;
  letter-spacing:.15em;
}
.school-tagline{
  font:400 13px "Bebas Neue",sans-serif;
  letter-spacing:.22em;
}

/* Player header row (back-of-card feel) */
.schoolrow{
  display:flex;align-items:flex-start;gap:16px;
  padding:10px var(--containerPad) 4px;
}
.player-photo-wrap{
  position:relative;
  display:inline-block;
}
.ham-logo{
  width:auto;height:160px;
  aspect-ratio:5/7;
  object-fit:cover;
  border-radius:10px;
  background:#000;
}
.superfan-overlay-link{
  position:absolute;
  left:50%;bottom:8px;
  transform:translateX(-50%);
  padding:5px 10px;
  border:none;
  border-radius:999px;
  font-family:Oswald,system-ui,sans-serif;
  font-size:11px;
  letter-spacing:.08em;
  text-transform:uppercase;
  background:rgba(0,0,0,.78);
  color:#f5f5f5;
  cursor:pointer;
  max-width:92%;
  text-align:center;
}
.superfan-overlay-link span{}

/* text block next to photo */
.schooltext{flex:1;min-width:0}
.schooltext .team-line{
  font:300 13px Oswald;
  color:var(--muted);
  margin-bottom:2px;
}
.schooltext .big1{font:400 24px "Bebas Neue",sans-serif;letter-spacing:.12em;}
.bio-line{
  font:300 12px Oswald;
  color:#555;
  margin-top:4px;
}

/* Tabs */
.hero{padding:4px 0}
.profile-nav{
  display:flex;justify-content:space-around;
  border-top:1px solid var(--line);
  border-bottom:1px solid var(--line);
  padding:4px 0;
}
.profile-nav-link{
  background:none;border:none;color:#555;
  font:700 clamp(10px, 2.5vw, 13px) "Bebas Neue",sans-serif;
  letter-spacing:.08em;cursor:pointer;
  padding:8px 10px;
  border-bottom:2px solid transparent;
  transition:color .3s,border-color .3s;
}
.profile-nav-link.active{color:var(--fg);border-bottom-color:var(--fg)}

/* Main card */
.main{padding:8px 0 calc(var(--footerH) + 12px)}
#funzone{
  background:var(--card-bg);border-radius:12px;
  margin-top:16px;min-height:50vh;
  color:var(--ink);padding:16px;
  transition:background-color .3s;
}
.stats-header-bar{
  background:var(--line);color:var(--fg);
  text-align:center;padding:6px;
  font:700 12px "Bebas Neue",sans-serif;
  margin:0 0 12px;border-radius:6px;
}
.stats-grid{
  display:grid;grid-template-columns:repeat(4,1fr);
  gap:8px;text-align:center;
}
.stat-item{
  background:var(--line);
  border-radius:8px;
  padding:8px 5px;
}
.stat-label{font-size:11px;text-transform:uppercase;opacity:.7;margin-bottom:4px}
.stat-value{font-size:18px;font-weight:700;line-height:1}

/* News placeholder */
.news-card{display:flex;gap:10px;margin:10px 0;padding:8px;border-radius:10px;border:1px solid var(--line);align-items:center;}
.news-title{font:700 18px "Bebas Neue",sans-serif;letter-spacing:.03em;line-height:1.1;margin-bottom:4px}
.news-meta{font:300 12px Oswald, sans-serif;opacity:.8}

/* Drawer (hamburger) */
.drawer-mask{
  position:fixed;inset:0;
  background:rgba(0,0,0,.45);
  opacity:0;pointer-events:none;
  transition:opacity .2s;
  z-index:60;
}
.drawer{
  position:fixed;top:0;bottom:0;left:0;
  width:min(320px,80vw);
  background:#111;
  color:#f5f5f5;
  transform:translateX(-100%);
  transition:transform .22s ease-out;
  z-index:70;
  display:flex;flex-direction:column;
}
.drawer-header{
  display:flex;align-items:center;justify-content:space-between;
  padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.12);
}
.drawer.open{transform:translateX(0);}
.drawer-mask.visible{opacity:1;pointer-events:auto;}
.drawer-nav{padding:12px 16px;display:flex;flex-direction:column;gap:10px;}
.drawer-nav a{font:400 14px "Bebas Neue",sans-serif;letter-spacing:.08em;text-transform:uppercase;}

/* Footer */
.site-footer{position:fixed;left:0;right:0;bottom:0;height:var(--footerH);background:var(--bg);border-top:1px solid var(--line);z-index:40;}
.site-footer a{display:block;height:100%;width:100%}
.site-footer img{height:100%;width:100%;object-fit:contain}
</style>
</head>

<body>
<header class="header">
  <div class="container topbar">
    <div class="left-icons">
      <button class="icon-btn" id="btnMenu" aria-label="Menu"><i class="ri-menu-line"></i></button>
      <div id="breadcrumbs" class="crumbs">
        <a href="index.html">HAMILTON</a> ▸ LOADING…
      </div>
    </div>
    <nav class="topnav" aria-label="Top Navigation">
      <a href="index.html" class="nav-pair"><span class="thin">WHERE THEY</span><span class="bold">YAT?</span></a>
      <a href="alumni-news.html" class="nav-pair"><span class="thin">ACTIVE ALUMNI</span><span class="bold">NEWS</span></a>
      <a href="all-time-list.html" class="nav-pair"><span class="thin">NEXT-LEVEL</span><span class="bold">ALL-TIME LIST</span></a>
    </nav>
    <div class="right-icons">
      <button class="icon-btn" id="theme-toggle" aria-label="Toggle Theme"><i class="ri-moon-line"></i></button>
      <button class="icon-btn" onclick="history.back()" aria-label="Back"><i class="ri-arrow-left-line"></i></button>
    </div>
  </div>
  <div class="hr-y"></div>

  <!-- SCHOOL HEADER (match list page) -->
  <section class="school-banner">
    <div class="container school-banner-inner">
      <img src="assets/img/logos/hamilton-h.png" alt="Hamilton Huskies" class="school-logo">
      <div class="school-banner-text">
        <div class="school-location">CHANDLER, AZ</div>
        <div class="school-name">HAMILTON HIGH SCHOOL</div>
        <div class="school-tagline">ACTIVE BASEBALL ALUMNI</div>
      </div>
    </div>
  </section>

  <!-- Player header row (back-of-card style) -->
  <div class="container schoolrow">
    <div class="player-photo-wrap">
      <img id="playerLogo" class="ham-logo" src="assets/img/placeholder.png" alt="Player Photo">
      <button id="superfanOverlayBtn" class="superfan-overlay-link">
        <span>ADD TO MY SUPERFAN DASHBOARD</span>
      </button>
    </div>
    <div class="schooltext">
      <div id="playerTeamOrg" class="team-line">LOADING PLAYER…</div>
      <div id="playerFirstName" class="big1"></div>
      <div id="playerLastName" class="big1"></div>
      <div id="playerBioLine" class="bio-line"></div>
    </div>
  </div>
  <div class="hr-y"></div>
</header>

<section class="hero">
  <div class="container">
    <nav id="profileNav" class="profile-nav">
      <button class="profile-nav-link active" data-content="stats">SEASON &amp; CAREER STATISTICS</button>
      <button class="profile-nav-link" data-content="news">NEWS &amp; VIDEO CLIPS</button>
      <button class="profile-nav-link" data-content="social">SOCIAL MEDIA</button>
      <button class="profile-nav-link" data-content="mentor">MENTORSHIP MARKETPLACE</button>
      <button class="profile-nav-link" data-content="gallery">TIMELINE GALLERY</button>
    </nav>
  </div>
</section>

<div class="drawer-mask" id="drawerMask"></div>
<aside class="drawer" id="drawerLeft">
  <div class="drawer-header">
    <span style="font-family:'Bebas Neue',sans-serif;letter-spacing:.08em;">HAMILTON NAV</span>
    <button class="icon-btn" id="drawerClose" aria-label="Close Menu"><i class="ri-close-line"></i></button>
  </div>
  <div class="drawer-nav">
    <a href="index.html">WHERE THEY YAT?</a>
    <a href="alumni-news.html">ACTIVE ALUMNI NEWS</a>
    <a href="all-time-list.html">NEXT-LEVEL ALL-TIME LIST</a>
    <a href="marketplace.html">MENTORSHIP MARKETPLACE</a>
    <a href="current-team.html">THE CURRENT TEAM</a>
    <a href="partner-program.html">PCD ACTION PARTNER PROGRAM</a>
    <a href="faq.html">FAQ’S</a>
  </div>
</aside>

<main class="main container">
  <div id="funzone" aria-live="polite">
    <p style="opacity:.8">Loading player data…</p>
  </div>
</main>

<footer class="site-footer">
  <a href="https://www.flowpage.com/petedeluca" target="_blank" rel="noopener noreferrer">
    <img src="assets/img/partners/american_banner.png" alt="Sponsor Banner">
  </a>
</footer>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQcWJM6Q6hTdFnES_G5LUy4teCS-sJ5HdAc9F5HSY8DGE9egdGy8yUAe2ShT3tFm-CwUuCYeAYy_YiW/pub?gid=2028135390&single=true&output=csv";
const FAVORITES_KEY = "YAT_FAN_FAVORITES_HAMILTON";
const SUPERFAN_PRICE = "$4.99";

const $  = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
const clean = v => (v||"").toString().trim();

function normalizeSlugStr(s){
  return clean(s).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");
}
function slugOf(p){
  const raw = clean(p.slug);
  if (raw) return normalizeSlugStr(raw);
  const nm = clean(p.display_name);
  return nm ? normalizeSlugStr(nm) : "";
}
function imageNameOf(p){
  const f = clean(p.first).toLowerCase();
  const l = clean(p.last).toLowerCase();
  const base = (f && l) ? `${f}_${l}` : normalizeSlugStr(p.display_name);
  return base.replace(/[^a-z0-9_]+/g,"");
}
function getParam(name){
  const v = new URLSearchParams(location.search).get(name);
  return v ? decodeURIComponent(v) : "";
}
function formatStatValue(key, value){
  if (!value || value === "--") return "--";
  const dec = ["AVG","OBP","SLG","OPS"];
  if (dec.includes(String(key).toUpperCase())){
    const num = parseFloat(value); if (isNaN(num)) return value;
    let s = num.toFixed(3);
    if (num>-1 && num<1) s = s.substring(1);
    return s;
  }
  return value;
}
async function loadCSV(url){
  const res = await fetch(url,{cache:"no-store"});
  if(!res.ok) throw new Error("CSV "+res.status);
  const text = await res.text();
  const lines = text.trim().split(/\r?\n/);
  if(!lines.length) return [];
  const splitCSV = line => line.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/).map(c=>c.replace(/^"|"$/g,""));
  const header = splitCSV(lines[0]).map(h=>h.trim());
  const rows   = lines.slice(1).map(splitCSV);
  const idxOf = name => header.findIndex(h=>h.toLowerCase()===name.toLowerCase());
  const statKeys = ["avg","obp","slg","ops","ab","h","r","rbi","2b","3b","hr","sb","bb","era","k/9","k/bb","whip","ip","er","ko","gp","w-l","saves","fip"];
  return rows.map((row,i)=>{
    const get = name => { const j=idxOf(name); return j>=0 ? row[j] : ""; };
    const p = {
      id:get("id")||String(i+2),
      tbc_id:get("tbc_id"),
      slug:get("slug"),
      display_name:get("display_name"),
      first:get("first"), last:get("last"),
      grad_class:get("grad_class"), letter_years:get("letter_years"),
      status:get("status"), level:get("level"),
      team:get("team"), org:get("org"),
      position:get("position"),
      height:get("height"), weight:get("weight"),
      bats:get("bats"), throws:get("throws"),
      draft_info:get("Draft_Info")||get("draft_info"),
      colleges:get("Colleges")||get("colleges"),
      x_handle:get("x_handle"), ig_handle:get("ig_handle"),
      video_url:get("video_url"), nil_score:get("nil_score"),
      stats:{}
    };
    statKeys.forEach(k=>{
      const v = get(k)||get(k.toUpperCase());
      if (v) p.stats[k.toUpperCase()] = v;
    });
    return p;
  });
}

/* favorites */
function getFavorites(){ try{return JSON.parse(localStorage.getItem(FAVORITES_KEY)||"[]");}catch{return[];} }
function saveFavorites(arr){ localStorage.setItem(FAVORITES_KEY, JSON.stringify(arr)); }
function isFavorite(p){ return getFavorites().includes(slugOf(p)); }
function toggleFavorite(p){
  const slug = slugOf(p); if(!slug) return false;
  const arr = getFavorites();
  const idx = arr.indexOf(slug);
  if(idx===-1) arr.push(slug); else arr.splice(idx,1);
  saveFavorites(arr);
  return arr.indexOf(slug)!==-1;
}
function setStarState(btn, active){
  if(!btn) return;
  const icon = btn.querySelector("i");
  btn.classList.toggle("active",active);
  if(icon){
    icon.classList.remove(active ? "ri-star-line" : "ri-star-fill");
    icon.classList.add(active ? "ri-star-fill" : "ri-star-line");
  }
}

/* SuperFan upsell */
function showSuperFanUpsell(){
  alert(
    "SuperFan Subscription\n\n" +
    "Become a SuperFan for " + SUPERFAN_PRICE + " / month.\n" +
    "This will add a SuperFan subscription to your cart. " +
    "Once your SuperFan transaction is completed, players you add " +
    "with this button will appear on your personal SuperFan dashboard."
  );
}

/* Renderers */
function statsGrid(p){
  const isPitcher = p.stats["ERA"]!==undefined;
  const bat = ["AVG","OBP","SLG","OPS","H","R","HR","RBI","AB","2B","3B","SB"];
  const pit = ["ERA","K/9","K/BB","WHIP","IP","ER","KO","BB","GP","W-L","SAVES","FIP"];
  const show = isPitcher ? pit : bat;
  const label = (p.status||"").toUpperCase().includes("ACTIVE") ? "2025 SEASON STATS" : "CAREER STATS";
  return `<div class="stats-header-bar">${label}</div>
    <div class="stats-grid">
      ${show.map(s=>`
        <div class="stat-item">
          <div class="stat-label">${s}</div>
          <div class="stat-value">${formatStatValue(s,p.stats[s])}</div>
        </div>`).join("")}
    </div>`;
}
function newsHTML(p){
  return `<div class="stats-header-bar">NEWS &amp; VIDEO CLIPS</div>
    <div class="news-card">
      <div>
        <div class="news-title">Custom news feed for ${clean(p.display_name)}</div>
        <div class="news-meta">Coming soon – we’ll surface alumni news links here.</div>
      </div>
    </div>`;
}
function socialHTML(p){
  const links=[];
  if(p.x_handle) links.push(`<a href="https://x.com/${p.x_handle}" target="_blank" rel="noopener">X / Twitter</a>`);
  if(p.ig_handle) links.push(`<a href="https://instagram.com/${p.ig_handle}" target="_blank" rel="noopener">Instagram</a>`);
  const content = links.length?links.join(" &nbsp;•&nbsp; "):"No social links available yet.";
  return `<div class="stats-header-bar">SOCIAL MEDIA</div><p style="padding:12px;">${content}</p>`;
}
function mentorHTML(p){
  if(!p.nil_score){
    return `<div class="stats-header-bar">MENTORSHIP MARKETPLACE</div>
      <p style="padding:12px;text-align:center;opacity:.8">Mentorship not yet available for ${clean(p.display_name)}.</p>`;
  }
  return `<div class="stats-header-bar">MENTORSHIP MARKETPLACE</div>
    <p style="padding:12px;text-align:center;">
      Upload your baseball video (hitting, throwing, fielding, etc.) and get feedback from ${clean(p.display_name)}.
    </p>`;
}
function galleryHTML(){
  return `<div class="stats-header-bar">TIMELINE GALLERY</div>
    <p style="text-align:center;opacity:.8;padding:12px;">Timeline gallery coming soon.</p>`;
}
function renderTab(p,tab){
  const zone=$("#funzone"); if(!zone) return;
  switch(tab){
    case"stats":zone.innerHTML=statsGrid(p);break;
    case"news":zone.innerHTML=newsHTML(p);break;
    case"social":zone.innerHTML=socialHTML(p);break;
    case"mentor":zone.innerHTML=mentorHTML(p);break;
    case"gallery":zone.innerHTML=galleryHTML();break;
  }
}

/* Theme + drawer */
function setupTheme(){
  const btn=$("#theme-toggle"); if(!btn) return;
  const icon=btn.querySelector("i");
  const apply=()=>{
    const saved=localStorage.getItem("theme");
    const dark = saved==="dark";
    document.body.classList.toggle("dark-theme",dark);
    if(icon){
      icon.classList.remove(dark?"ri-moon-line":"ri-sun-line");
      icon.classList.add(dark?"ri-sun-line":"ri-moon-line");
    }
  };
  btn.addEventListener("click",()=>{
    const darkNow=!document.body.classList.contains("dark-theme");
    localStorage.setItem("theme",darkNow?"dark":"light");
    apply();
  });
  apply();
}
function setupDrawer(){
  const btn=$("#btnMenu"), mask=$("#drawerMask"), drawer=$("#drawerLeft"), close=$("#drawerClose");
  if(!btn||!mask||!drawer) return;
  const open=()=>{drawer.classList.add("open");mask.classList.add("visible");};
  const shut=()=>{drawer.classList.remove("open");mask.classList.remove("visible");};
  btn.addEventListener("click",open);
  mask.addEventListener("click",shut);
  if(close) close.addEventListener("click",shut);
}

/* resolve player */
function resolvePlayer(players){
  const byParam=getParam("player");
  const byId=getParam("id");
  const byName=getParam("name");
  if(byParam){
    const want=normalizeSlugStr(byParam);
    const hit=players.find(p=>slugOf(p)===want); if(hit) return hit;
  }
  if(byId){
    const want=String(byId).toLowerCase();
    const hit=players.find(p=>String(p.id||"").toLowerCase()===want); if(hit) return hit;
  }
  if(byName){
    const want=clean(byName).toLowerCase();
    const hit=players.find(p=>clean(p.display_name).toLowerCase()===want); if(hit) return hit;
  }
  if(!byParam&&!byId&&!byName){
    const q=location.search.replace(/^\?/,"");
    if(q && !q.includes("=")){
      const want=normalizeSlugStr(q);
      const hit=players.find(p=>slugOf(p)===want); if(hit) return hit;
    }
  }
  return players[0];
}

/* boot */
document.addEventListener("DOMContentLoaded",async()=>{
  try{
    setupTheme();
    setupDrawer();
    const players=await loadCSV(CSV_URL);
    if(!players.length) throw new Error("No roster rows");
    const p=resolvePlayer(players);

    // breadcrumbs with star
    const crumbs=$("#breadcrumbs");
    if(crumbs){
      crumbs.innerHTML = `<a href="index.html">HAMILTON</a> ▸ 
        <span class="crumb-player-name">${clean(p.display_name)}</span>
        <button id="starFollowBtn" class="crumb-star" aria-label="Mark as favorite">
          <i class="ri-star-line"></i>
        </button>`;
    }

    $("#playerFirstName").textContent = clean(p.first);
    $("#playerLastName").textContent  = clean(p.last);
    $("#playerTeamOrg").textContent   = `${clean(p.team)} • ${clean(p.org)}`;
    $("#playerBioLine").textContent   =
      `${clean(p.level||"")} ${p.status?("• "+clean(p.status)):""}`
      .replace(/\s+/g," ").trim();

    const nm=imageNameOf(p);
    const img=$("#playerLogo");
    if(img){
      const jpg=`assets/img/now_players/${nm}.jpg`;
      const png=`assets/img/now_players/${nm}.png`;
      img.src=jpg;
      img.onerror=function(){this.onerror=null;this.src=png;};
    }

    const overlay=$("#superfanOverlayBtn");
    if(overlay){
      overlay.addEventListener("click",()=>showSuperFanUpsell());
    }

    const starBtn=$("#starFollowBtn");
    if(starBtn){
      setStarState(starBtn,isFavorite(p));
      starBtn.addEventListener("click",()=>{
        const nowFav=toggleFavorite(p);
        setStarState(starBtn,nowFav);
        alert(nowFav
          ? "Added to your Hamilton Favorites.\n\nWhen you register for a free Fan account you'll be able to filter by Favorites only."
          : "Removed from your Hamilton Favorites.");
      });
    }

    const nav=$("#profileNav");
    if(nav){
      nav.addEventListener("click",e=>{
        const btn=e.target.closest(".profile-nav-link"); if(!btn) return;
        $$(".profile-nav-link").forEach(b=>b.classList.remove("active"));
        btn.classList.add("active");
        renderTab(p,btn.dataset.content);
      });
    }
    const tabParam=(getParam("tab")||"stats").toLowerCase();
    const valid=["stats","news","social","mentor","gallery"];
    const current=valid.includes(tabParam)?tabParam:"stats";
    renderTab(p,current);
    $$(".profile-nav-link").forEach(b=>b.classList.toggle("active",b.dataset.content===current));
  }catch(e){
    console.error(e);
    const fun=$("#funzone");
    if(fun) fun.innerHTML=`<p style="color:#c00">Failed to load profile: ${e.message}</p>`;
  }
});
</script>
</body>
</html>